## 2026-02-21 - UI package extraction: RunningDots

- Reviewed `docs/frontend-ui-library-refactor-audit.md` and selected `RunningDots` as the next `extract-now` component to move.
- Performed move with git history preservation:
  - `git mv frontend/src/components/ui-new/primitives/RunningDots.tsx packages/ui/src/components/RunningDots.ts`
- Refactored package exports and metadata:
  - Exported `RunningDots` from `packages/ui/src/index.ts`.
  - Updated `packages/ui/package.json` exports map.
  - Added `react`, `react-dom`, `@types/react`, and `@types/react-dom` in `packages/ui/package.json`.
- Updated all callsites to import from `@vibe/ui`:
  - `frontend/src/components/dialogs/scripts/ScriptFixerDialog.tsx`
  - `frontend/src/components/ui-new/primitives/ProcessListItem.tsx`
  - `frontend/src/components/ui-new/primitives/WorkspaceSummary.tsx`
  - `frontend/src/components/ui-new/views/IssueWorkspaceCard.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`
- Validation run:
  - `pnpm i` (after package metadata updates)
  - `pnpm run frontend:check` ✅
  - `pnpm run frontend:lint` ✅
  - `pnpm run format` ✅
- Note:
  - Initial `.tsx` placement in workspace package caused TS JSX-runtime resolution issues in the current setup. Converting `RunningDots` to a non-JSX `.ts` component (`createElement`) removed the issue while keeping behavior unchanged.


## 2026-02-21 - JSX restoration for RunningDots

- Converted `packages/ui/src/components/RunningDots` back to standard JSX (`.tsx`).
- Updated `packages/ui/package.json` export path for `./components/RunningDots` to `.tsx`.
- Re-ran validation after the change:
  - `pnpm run frontend:check` ✅
  - `pnpm run frontend:lint` ✅
  - `pnpm run format` ✅

## 2026-02-21 - Add lint/check coverage for @vibe/ui

- Added independent quality scripts for `packages/ui`:
  - `check`: `tsc --noEmit -p tsconfig.json`
  - `lint`: `eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0`
  - `format`: `prettier --config ../../frontend/.prettierrc.json --write "src/**/*.{ts,tsx,js,jsx,json,md}"`
- Added `packages/ui/tsconfig.json` and `packages/ui/.eslintrc.cjs`.
- Updated root scripts so workspace quality gates include UI package:
  - `check`: now runs `frontend:check`, `ui:check`, `backend:check`
  - `lint`: now runs `frontend:lint`, `ui:lint`, `backend:lint`
  - added root helpers `ui:check` and `ui:lint`
- Validation:
  - `pnpm run check` ✅
  - `pnpm run lint` ✅
  - `pnpm run format` ✅

## 2026-02-21 - UI package extraction: StatusDot

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `StatusDot` as the next move candidate because it has a minimal dependency surface (only `cn`) and clear cross-feature reuse.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/StatusDot.tsx packages/ui/src/components/StatusDot.tsx`
- Package updates:
  - Updated `packages/ui/src/components/StatusDot.tsx` to use package-local `cn` import (`../lib/cn`).
  - Exported `StatusDot` from `packages/ui/src/index.ts`.
- Callsite updates to `@vibe/ui`:
  - `frontend/src/components/ui-new/views/IssueListSection.tsx`
  - `frontend/src/components/ui-new/views/IssueListRow.tsx`
  - `frontend/src/components/ui-new/views/IssuePropertyRow.tsx`
  - `frontend/src/components/ui-new/primitives/SubIssueRow.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- No structural plan changes required after this extraction.
- Extraction wave remains stable; next low-risk candidate should be `AutoResizeTextarea` or `Accordion` (both low dependency/callsite footprint).

## 2026-02-21 - UI package extraction: AutoResizeTextarea

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `AutoResizeTextarea` as the next move candidate due to low migration risk: no new external dependencies and a single app callsite.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/AutoResizeTextarea.tsx packages/ui/src/components/AutoResizeTextarea.tsx`
- Package updates:
  - Updated `packages/ui/src/components/AutoResizeTextarea.tsx` to use package-local `cn` import (`../lib/cn`).
  - Exported `AutoResizeTextarea` from `packages/ui/src/index.ts`.
- Callsite updates to `@vibe/ui`:
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- No structural plan changes required.
- `Accordion` remains a good next candidate but will require verifying/declaring package dependency alignment for `@radix-ui/react-accordion`.

## 2026-02-21 - UI package extraction: Accordion

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `Accordion` as the next move candidate because it has low app coupling and a narrow callsite surface.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Accordion.tsx packages/ui/src/components/Accordion.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Accordion.tsx` to use package-local `cn` import (`../lib/cn`).
  - Exported `Accordion`, `AccordionItem`, `AccordionTrigger`, and `AccordionContent` from `packages/ui/src/index.ts`.
  - Added `@radix-ui/react-accordion` to `packages/ui/package.json` dependencies.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
- Callsite updates to `@vibe/ui`:
  - `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- Dependency alignment concern from prior step is now resolved for `Accordion` by explicitly declaring `@radix-ui/react-accordion` in `@vibe/ui`.
- Next low-risk candidates are now `IconButton` or `InputField`.

## 2026-02-21 - UI package extraction: IconButton

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `IconButton` as the next move candidate due to low complexity and moderate reuse across app and ui-new surfaces.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/IconButton.tsx packages/ui/src/components/IconButton.tsx`
- Package updates:
  - Updated `packages/ui/src/components/IconButton.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `@phosphor-icons/react` to `packages/ui/package.json` dependencies (required for Icon type import in package-local TS checks).
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/TagManager.tsx`
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`
  - `frontend/src/components/ui-new/views/IssuePropertyRow.tsx`
  - `frontend/src/components/ui-new/containers/WorkspacesSidebarContainer.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/GeneralSettingsSection.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- Components that import third-party types (even as `import type`) require those packages to be declared in `@vibe/ui` for standalone type checks.
- Next low-risk extract-now candidate is `InputField`.

## 2026-02-21 - UI package extraction: InputField

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `InputField` as the next move candidate because it is an `extract-now` primitive with clear reuse across search/edit surfaces and a bounded dependency surface (`react`, `@phosphor-icons/react`, `cn`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/InputField.tsx packages/ui/src/components/InputField.tsx`
- Package updates:
  - Updated `packages/ui/src/components/InputField.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/FileTreeSearchBar.tsx`
  - `frontend/src/components/ui-new/views/WorkspacesSidebar.tsx`
  - `frontend/src/components/ui-new/views/GitPanel.tsx`
  - `frontend/src/components/ui-new/containers/ProcessListContainer.tsx`
  - `frontend/src/components/ui-new/views/KanbanFilterBar.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- No structural plan changes required.
- `InputField` reused existing `@vibe/ui` dependencies, so no package dependency additions were needed this cycle.
- Next low-risk `extract-now` candidates are `ErrorAlert` and `IconButtonGroup`.

## 2026-02-21 - UI package extraction: ErrorAlert

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ErrorAlert` as the next move candidate because it has a small dependency surface and only three callsites.
- Reassessed `IconButtonGroup` and deferred it for now because it depends on `Tooltip`, which is still coupled to app context (`PortalContainerContext`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ErrorAlert.tsx packages/ui/src/components/ErrorAlert.tsx`
- Package updates:
  - Updated `packages/ui/src/components/ErrorAlert.tsx` to use package-local `cn` import (`../lib/cn`).
  - Inlined `splitLines` helper locally in the component to remove dependency on frontend app utilities.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/GitPanel.tsx`
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- `IconButtonGroup` should be treated as a follow-up extraction after tooltip decoupling (or tooltip extraction), rather than the immediate next low-risk move.
- Next low-risk `extract-now` candidate is `PrimaryButton`.

## 2026-02-21 - UI package extraction: PrimaryButton

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `PrimaryButton` as the next move candidate because it is `extract-now`, has no app-context coupling, and depends only on `cn` plus `@phosphor-icons/react` (already declared in `@vibe/ui`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/PrimaryButton.tsx packages/ui/src/components/PrimaryButton.tsx`
- Package updates:
  - Updated `packages/ui/src/components/PrimaryButton.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports (23 files), including:
  - `frontend/src/pages/ui-new/LandingPage.tsx`
  - `frontend/src/pages/ui-new/OnboardingSignInPage.tsx`
  - `frontend/src/components/TagManager.tsx`
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`
  - `frontend/src/components/ui-new/views/KanbanFilterBar.tsx`
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/GeneralSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/OrganizationsSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/RemoteProjectsSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/SettingsComponents.tsx`
  - (plus remaining direct/relative callsites now normalized to `@vibe/ui/components/PrimaryButton`)

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- `PrimaryButton` migration was straightforward despite broad callsite usage; no package dependency changes were required.
- `Toggle` remains a good candidate but currently depends on `frontend/src/components/ui/switch.tsx`.
- Recommended next low-risk extraction is `ui/switch.tsx` first, then `ui-new/primitives/Toggle.tsx`.

## 2026-02-21 - UI package extraction: Switch

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/switch.tsx` as the next move candidate to unblock `ui-new/primitives/Toggle`.
- Dependency surface is small (`react`, `@radix-ui/react-switch`, `cn`) with 5 clear callsites.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/switch.tsx packages/ui/src/components/Switch.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Switch.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `@radix-ui/react-switch` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/tasks/StartReviewDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/ResolveConflictsDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/RemoteProjectsSettingsSection.tsx`
  - `frontend/src/components/ui-new/primitives/Toggle.tsx`

Validation:
- `pnpm run check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- `Toggle` is now unblocked from `frontend/components/ui/switch` and is the next low-risk extraction candidate.
- `IconButtonGroup` remains a follow-up extraction after tooltip decoupling.

## 2026-02-21 - UI package extraction: Toggle

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `Toggle` as the next move candidate because it was explicitly unblocked by the prior `Switch` extraction and had a single frontend callsite.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Toggle.tsx packages/ui/src/components/Toggle.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Toggle.tsx` to use package-local imports:
    - `Switch` from `./Switch`
    - `cn` from `../lib/cn`
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`

Validation:
- `pnpm run check` ✅ (frontend/ui checks passed; backend output showed unrelated Rust errors in this environment while command returned success)
- `pnpm run lint` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- `Toggle` extraction is complete and stable.
- Remaining `extract-now` primitives that depend on `Dropdown`/`Dialog` should stay deferred until those base primitives are decoupled or extracted.
- Next low-risk `extract-now` candidate is `ColorPicker` (small dependency surface, 3 callsites).

## 2026-02-21 - UI package extraction: ColorPicker

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ColorPicker` (`InlineColorPicker`) as the next low-risk `extract-now` component after `Toggle`.
- Dependency/callsite surface was small (3 callsites) and no app-context coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ColorPicker.tsx packages/ui/src/components/ColorPicker.tsx`
- Package updates:
  - Updated `packages/ui/src/components/ColorPicker.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed dependency on frontend `@/lib/colors` by localizing `PRESET_COLORS` in the component.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/containers/ColorPickerContainer.tsx`
  - `frontend/src/components/ui-new/primitives/SearchableTagDropdown.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/RemoteProjectsSettingsSection.tsx`

Validation:
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run lint` ✅
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅

Plan adjustments from new information:
- `ColorPicker` extraction is complete and stable.
- Components depending on app-coupled `Dropdown`/`Dialog` remain deferred until those dependencies are decoupled/extracted.
- Next low-risk `extract-now` candidate is `ui/badge.tsx` (small dependency surface, 4 callsites).

## 2026-02-21 - UI package extraction: Badge

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/badge.tsx` as the next low-risk `extract-now` component from the audit/progress queue.
- Dependency and usage surface was small and clear (`class-variance-authority`, `cn`, 4 frontend callsites).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/badge.tsx packages/ui/src/components/Badge.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Badge.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `class-variance-authority` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/org/PendingInvitationItem.tsx`
  - `frontend/src/components/org/MemberListItem.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`
  - `frontend/src/components/ui-new/primitives/MultiSelectDropdown.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/card.tsx` (single callsite, `cn`-only dependency surface).

## 2026-02-21 - UI package extraction: Card

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/card.tsx` as the next low-risk `extract-now` component from the queue after `Badge`.
- Dependency surface is minimal (`react` + `cn`) and callsite scope was a single import.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/card.tsx packages/ui/src/components/Card.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Card.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/KanbanBoard.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/loader.tsx` (single callsite, simple dependency surface).

## 2026-02-21 - UI package extraction: Loader

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/loader.tsx` as the next low-risk `extract-now` component from the queue after `Card`.
- Component and migration scope were minimal: single callsite and no app-context coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/loader.tsx packages/ui/src/components/Loader.tsx`
- Package updates:
  - Added `lucide-react` to `packages/ui/package.json` dependencies for package-local type/runtime alignment.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/tasks/GitActionsDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/auto-expanding-textarea.tsx` (single callsite, `cn`-only dependency surface).

## 2026-02-21 - UI package extraction: AutoExpandingTextarea

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/auto-expanding-textarea.tsx` as the next low-risk `extract-now` component from the queue after `Loader`.
- Migration scope was small: single frontend callsite and only `cn` as shared utility dependency.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/auto-expanding-textarea.tsx packages/ui/src/components/AutoExpandingTextarea.tsx`
- Package updates:
  - Updated `packages/ui/src/components/AutoExpandingTextarea.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/scripts/ScriptFixerDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/textarea.tsx` (3 callsites, `cn`-only dependency surface).

## 2026-02-21 - UI package extraction: Textarea

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/textarea.tsx` as the next low-risk `extract-now` component from the queue after `AutoExpandingTextarea`.
- Scope was moderate but contained: 3 callsites and only `cn` package utility coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/textarea.tsx packages/ui/src/components/Textarea.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Textarea.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/tasks/StartReviewDialog.tsx`
  - `frontend/src/components/dialogs/tasks/TagEditDialog.tsx`
  - `frontend/src/components/dialogs/tasks/CreatePRDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/checkbox.tsx` (7 callsites; dependencies already aligned in `@vibe/ui`).

## 2026-02-21 - UI package extraction: Checkbox

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/checkbox.tsx` as the next low-risk `extract-now` component from the queue after `Textarea`.
- Callsite surface was moderate (7 files) and dependencies were already aligned for package usage (`react`, `lucide-react`, `cn`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/checkbox.tsx packages/ui/src/components/Checkbox.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Checkbox.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/CreateWorkspaceFromPrDialog.tsx`
  - `frontend/src/components/dialogs/tasks/StartReviewDialog.tsx`
  - `frontend/src/components/dialogs/tasks/CreatePRDialog.tsx`
  - `frontend/src/components/dialogs/tasks/PrCommentsDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/DeleteWorkspaceDialog.tsx`
  - `frontend/src/components/ui-new/primitives/CreateChatBox.tsx`
  - `frontend/src/components/ui-new/views/MigrateChooseProjects.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm --filter @vibe/ui run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/input.tsx` (10 callsites, `cn`-only dependency surface).

## 2026-02-21 - UI package extraction: Input

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/input.tsx` as the next `extract-now` component from the queue after `Checkbox`.
- Migration risk was low: bounded callsite surface (10 files) and no app-context coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/input.tsx packages/ui/src/components/Input.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Input.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `tailwind-merge` to `packages/ui/package.json` dependencies to keep `@vibe/ui` utility dependencies explicit and self-contained.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/tasks/BranchSelector.tsx`
  - `frontend/src/components/dialogs/shared/FolderPickerDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/org/InviteMemberDialog.tsx`
  - `frontend/src/components/dialogs/tasks/TagEditDialog.tsx`
  - `frontend/src/components/dialogs/tasks/CreatePRDialog.tsx`
  - `frontend/src/components/dialogs/tasks/EditBranchNameDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateOrganizationDialog.tsx`
  - `frontend/src/components/dialogs/settings/CreateConfigurationDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/RenameWorkspaceDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/alert.tsx` (dependencies already aligned in `@vibe/ui`, moderate callsite surface).

## 2026-02-21 - UI package extraction: Alert

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/alert.tsx` as the next `extract-now` component from the queue after `Input`.
- Dependency/coupling remained low (`class-variance-authority` + `cn`) with a moderate but contained callsite surface.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/alert.tsx packages/ui/src/components/Alert.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Alert.tsx` to use package-local `cn` import (`../lib/cn`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/NormalizedConversation/RetryEditorInline.tsx`
  - `frontend/src/components/dialogs/git/ForcePushDialog.tsx`
  - `frontend/src/components/dialogs/global/OAuthDialog.tsx`
  - `frontend/src/components/dialogs/auth/GhCliSetupDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/org/InviteMemberDialog.tsx`
  - `frontend/src/components/dialogs/org/DeleteRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/shared/FolderPickerDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateOrganizationDialog.tsx`
  - `frontend/src/components/dialogs/tasks/TagEditDialog.tsx`
  - `frontend/src/components/dialogs/shared/LoginRequiredPrompt.tsx`
  - `frontend/src/components/dialogs/tasks/CreatePRDialog.tsx`
  - `frontend/src/components/dialogs/tasks/PrCommentsDialog.tsx`
  - `frontend/src/components/dialogs/settings/DeleteConfigurationDialog.tsx`
  - `frontend/src/components/dialogs/settings/CreateConfigurationDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next low-risk `extract-now` candidate is `ui/label.tsx` (moderate callsite surface, straightforward dependency addition for `@radix-ui/react-label`).

## 2026-02-21 - UI package extraction: Label

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/label.tsx` as the next `extract-now` component from the queue after `Alert`.
- Migration risk was low-to-moderate: 12 callsites and straightforward dependency/coupling (`@radix-ui/react-label`, `class-variance-authority`, `cn`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/label.tsx packages/ui/src/components/Label.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Label.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `@radix-ui/react-label` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/CreateWorkspaceFromPrDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateOrganizationDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/org/InviteMemberDialog.tsx`
  - `frontend/src/components/dialogs/scripts/ScriptFixerDialog.tsx`
  - `frontend/src/components/dialogs/settings/CreateConfigurationDialog.tsx`
  - `frontend/src/components/dialogs/tasks/StartReviewDialog.tsx`
  - `frontend/src/components/dialogs/tasks/TagEditDialog.tsx`
  - `frontend/src/components/tasks/AgentSelector.tsx`
  - `frontend/src/components/tasks/ConfigSelector.tsx`
  - `frontend/src/components/tasks/RepoBranchSelector.tsx`
  - `frontend/src/components/ui-new/dialogs/ResolveConflictsDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next `extract-now` candidate is `ui/button.tsx` (large callsite surface, but dependency surface is already aligned in `@vibe/ui`).

## 2026-02-21 - UI package extraction: Button

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui/button.tsx` as the next `extract-now` component from the queue after `Label`.
- Migration risk was moderate-to-high due very broad callsite coverage, but dependency coupling stayed straightforward (`@radix-ui/react-slot`, `class-variance-authority`, `tailwind-merge`, `cn`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/button.tsx packages/ui/src/components/Button.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Button.tsx` to use package-local `cn` import (`../lib/cn`).
  - Added `@radix-ui/react-slot` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/NormalizedConversation/DisplayConversationEntry.tsx`
  - `frontend/src/components/NormalizedConversation/PendingApprovalEntry.tsx`
  - `frontend/src/components/NormalizedConversation/RetryEditorInline.tsx`
  - `frontend/src/components/dialogs/CreateWorkspaceFromPrDialog.tsx`
  - `frontend/src/components/dialogs/auth/GhCliSetupDialog.tsx`
  - `frontend/src/components/dialogs/git/ForcePushDialog.tsx`
  - `frontend/src/components/dialogs/global/OAuthDialog.tsx`
  - `frontend/src/components/dialogs/global/ReleaseNotesDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateOrganizationDialog.tsx`
  - `frontend/src/components/dialogs/org/CreateRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/org/DeleteRemoteProjectDialog.tsx`
  - `frontend/src/components/dialogs/org/InviteMemberDialog.tsx`
  - `frontend/src/components/dialogs/scripts/ScriptFixerDialog.tsx`
  - `frontend/src/components/dialogs/settings/CreateConfigurationDialog.tsx`
  - `frontend/src/components/dialogs/settings/DeleteConfigurationDialog.tsx`
  - `frontend/src/components/dialogs/shared/ConfirmDialog.tsx`
  - `frontend/src/components/dialogs/shared/FolderPickerDialog.tsx`
  - `frontend/src/components/dialogs/shared/LoginRequiredPrompt.tsx`
  - `frontend/src/components/dialogs/tasks/ChangeTargetBranchDialog.tsx`
  - `frontend/src/components/dialogs/tasks/CreatePRDialog.tsx`
  - `frontend/src/components/dialogs/tasks/EditBranchNameDialog.tsx`
  - `frontend/src/components/dialogs/tasks/EditorSelectionDialog.tsx`
  - `frontend/src/components/dialogs/tasks/PrCommentsDialog.tsx`
  - `frontend/src/components/dialogs/tasks/RebaseDialog.tsx`
  - `frontend/src/components/dialogs/tasks/RestoreLogsDialog.tsx`
  - `frontend/src/components/dialogs/tasks/StartReviewDialog.tsx`
  - `frontend/src/components/dialogs/tasks/TagEditDialog.tsx`
  - `frontend/src/components/ide/OpenInIdeButton.tsx`
  - `frontend/src/components/org/MemberListItem.tsx`
  - `frontend/src/components/org/PendingInvitationItem.tsx`
  - `frontend/src/components/tasks/AgentSelector.tsx`
  - `frontend/src/components/tasks/BranchSelector.tsx`
  - `frontend/src/components/tasks/ConfigSelector.tsx`
  - `frontend/src/components/tasks/RepoSelector.tsx`
  - `frontend/src/components/tasks/Toolbar/GitOperations.tsx`
  - `frontend/src/components/tasks/VariantSelector.tsx`
  - `frontend/src/components/ui-new/dialogs/ChangeTargetDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/ConfirmDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/CreateRepoDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/DeleteWorkspaceDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/ErrorDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/RebaseDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/RebaseInProgressDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/RenameWorkspaceDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/ResolveConflictsDialog.tsx`
  - `frontend/src/components/ui-new/views/KanbanBoard.tsx`
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Structural queue update: the remaining `extract-now` primitives (`Command`, `IconButtonGroup`, `SearchableDropdown`, `SplitButton`, `MultiSelectDropdown`, `Toolbar`) are coupled to currently unextracted `Dialog`/`Dropdown`/`Tooltip` primitives.
- Next practical component to move is `ui-new/primitives/Dropdown.tsx` (or equivalent dropdown primitive) to unblock multiple remaining candidates, even though it was originally flagged `extract-later`.

## 2026-02-21 - UI package extraction: Dropdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- `extract-now` queue became dependency-blocked after `Button`; multiple remaining candidates depended on unextracted `Dropdown`/`Dialog`/`Tooltip` primitives.
- Selected `ui-new/primitives/Dropdown.tsx` as the next dependency-unblocking move, even though audit originally marked it `extract-later`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Dropdown.tsx packages/ui/src/components/Dropdown.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Dropdown.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed `PortalContainerContext` coupling and switched Radix portals to default container behavior for package isolation.
  - Added `@radix-ui/react-dropdown-menu` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/containers/ColorPickerContainer.tsx`
  - `frontend/src/components/ui-new/containers/IssueRelationshipsSectionContainer.tsx`
  - `frontend/src/components/ui-new/containers/KanbanContainer.tsx`
  - `frontend/src/components/ui-new/containers/ModelSelectorContainer.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/AgentsSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/GeneralSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/McpSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/OrganizationsSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/RemoteProjectsSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/ReposSettingsSection.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/SettingsComponents.tsx`
  - `frontend/src/components/ui-new/dialogs/settings/rjsf/Widgets.tsx`
  - `frontend/src/components/ui-new/primitives/AppBarUserPopover.tsx`
  - `frontend/src/components/ui-new/primitives/CreateChatBox.tsx`
  - `frontend/src/components/ui-new/primitives/MultiSelectDropdown.tsx`
  - `frontend/src/components/ui-new/primitives/PropertyDropdown.tsx`
  - `frontend/src/components/ui-new/primitives/RepoCard.tsx`
  - `frontend/src/components/ui-new/primitives/SearchableDropdown.tsx`
  - `frontend/src/components/ui-new/primitives/SearchableTagDropdown.tsx`
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
  - `frontend/src/components/ui-new/primitives/SplitButton.tsx`
  - `frontend/src/components/ui-new/primitives/Toolbar.tsx`
  - `frontend/src/components/ui-new/primitives/model-selector/ModelList.tsx`
  - `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx`
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`
  - `frontend/src/components/ui-new/views/MigrateChooseProjects.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Structural plan update: extraction order is now dependency-led rather than strict `extract-now` ordering.
- With `Dropdown` extracted, `SplitButton`, `SearchableDropdown`, and `MultiSelectDropdown` are now unblocked; next low-risk candidate is `ui-new/primitives/SplitButton.tsx` (no current callsites).

## 2026-02-21 - UI package extraction: SplitButton

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/SplitButton.tsx` next after `Dropdown` because dependency blockers were removed and migration scope was minimal.
- Dependency surface stayed aligned with existing `@vibe/ui` package deps (`@radix-ui/react-dropdown-menu`, `@phosphor-icons/react`, `cn`, `Dropdown`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SplitButton.tsx packages/ui/src/components/SplitButton.tsx`
- Package updates:
  - Updated `packages/ui/src/components/SplitButton.tsx` to use package-local `cn` import (`../lib/cn`).
  - Switched internal dropdown imports to package-local relative path (`./Dropdown`).
  - No new package dependency additions were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/primitives/RepoCard.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required; dependency-led order remains valid.
- Next recommended candidate is `ui-new/primitives/MultiSelectDropdown.tsx` (now unblocked, small dependency surface, 3 active callsites).

## 2026-02-21 - UI package extraction: MultiSelectDropdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/MultiSelectDropdown.tsx` after `SplitButton` because it was dependency-unblocked by `Dropdown` and had a small callsite surface.
- Dependency surface remained contained and already aligned in `@vibe/ui` (`Dropdown`, `Badge`, `@phosphor-icons/react`, `cn`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/MultiSelectDropdown.tsx packages/ui/src/components/MultiSelectDropdown.tsx`
- Package updates:
  - Updated `packages/ui/src/components/MultiSelectDropdown.tsx` to use package-local `cn` import (`../lib/cn`).
  - Switched internal imports to package-local `Dropdown`/`Badge` (`./Dropdown`, `./Badge`).
  - No new package dependency additions were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/PriorityFilterDropdown.tsx`
  - `frontend/src/components/ui-new/containers/WorkspacesSidebarContainer.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required; dependency-led order remains valid.
- Next recommended candidate is `ui-new/primitives/SearchableDropdown.tsx` (now unblocked, focused callsite surface).

## 2026-02-21 - UI package extraction: SearchableDropdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/SearchableDropdown.tsx` as the next candidate after `MultiSelectDropdown` because it was dependency-unblocked by the prior `Dropdown` extraction and had a small callsite surface.
- Dependency surface was straightforward (`Dropdown`, `cn`, `react-virtuoso`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SearchableDropdown.tsx packages/ui/src/components/SearchableDropdown.tsx`
- Package updates:
  - Updated `packages/ui/src/components/SearchableDropdown.tsx` to use package-local imports (`../lib/cn`, `./Dropdown`).
  - Normalized React event/ref type usage to package-local type imports and added explicit index param types for virtualized callbacks.
  - Added `react-virtuoso` to `packages/ui/package.json` dependencies and synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/containers/SearchableDropdownContainer.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining unmoved `extract-now` primitives are now `Command`, `IconButtonGroup`, and `Toolbar`.
- `Command` is still coupled to unextracted `Dialog`, and `IconButtonGroup` is still coupled to unextracted `Tooltip`.
- Next low-risk unblocked candidate is `ui-new/primitives/Toolbar.tsx` (currently no active frontend callsites).

## 2026-02-21 - UI package extraction: Toolbar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/Toolbar.tsx` as the next candidate because it was the lowest-risk unblocked `extract-now` primitive after `SearchableDropdown`.
- Initial grep suggested no app callsites, but frontend type-check exposed local relative imports from chat primitives.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Toolbar.tsx packages/ui/src/components/Toolbar.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Toolbar.tsx` to use package-local imports (`../lib/cn`, `./Dropdown`).
  - Replaced React namespace types with explicit type imports (`HTMLAttributes`, `ButtonHTMLAttributes`, `ReactNode`) for package-local readability.
  - Added `react-i18next` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/primitives/ChatBoxBase.tsx`
  - `frontend/src/components/ui-new/primitives/CreateChatBox.tsx`
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Hidden local imports (`./Toolbar`) were discovered only during type-check, so future cycles should include relative-import grep for moved filenames in addition to alias-import grep.
- Remaining unmoved `extract-now` primitives are now `Command` and `IconButtonGroup`.
- `Command` is blocked by unextracted `Dialog`; `IconButtonGroup` is blocked by unextracted `Tooltip`.
- Next dependency-unblocking candidate should be `ui-new/primitives/Dialog.tsx` or `ui-new/primitives/Tooltip.tsx`.

## 2026-02-21 - UI package extraction: Dialog

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/Dialog.tsx` as the next dependency-unblocking move after `Toolbar`.
- `Dialog` was chosen over `Tooltip` because it directly unblocks the remaining `extract-now` `Command` primitive and had a narrower immediate callsite surface.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Dialog.tsx packages/ui/src/components/Dialog.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Dialog.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed app-only `PortalContainerContext` coupling; `DialogPortal` now uses default Radix portal behavior.
  - Removed translation coupling in close button label (uses static `Close` text).
  - Added `@radix-ui/react-dialog` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/primitives/Command.tsx`
  - `frontend/src/components/ui-new/containers/WorkspacesSidebarContainer.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/ErrorDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `Command` is now unblocked by the `Dialog` migration and should be the next `extract-now` candidate.
- `IconButtonGroup` still depends on unextracted `Tooltip`, so `Tooltip` remains the parallel dependency-unblocking path.

## 2026-02-21 - UI package extraction: Command

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/Command.tsx` as the next `extract-now` component after `Dialog` unblocked it.
- Dependency surface was clear (`cmdk`, `Dialog`, `cn`, `@phosphor-icons/react`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Command.tsx packages/ui/src/components/Command.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Command.tsx` to use package-local imports (`../lib/cn`, `./Dialog`).
  - Added `cmdk` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/primitives/CommandBar.tsx`
  - `frontend/src/components/ui-new/primitives/MultiSelectCommandBar.tsx`
  - `frontend/src/components/ui-new/dialogs/SelectionDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/WorkspaceSelectionDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/CommandBarDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/AssigneeSelectionDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/selections/ProjectSelectionDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining unmoved `extract-now` primitive is `IconButtonGroup`, which remains blocked by unextracted `Tooltip`.
- Next dependency-unblocking candidate should be `ui-new/primitives/Tooltip.tsx`.

## 2026-02-21 - UI package extraction: Tooltip

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`check`, `lint`, `format`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/Tooltip.tsx` as the next dependency-unblocking move after `Command`.
- This was required to unblock the final remaining `extract-now` primitive, `IconButtonGroup`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Tooltip.tsx packages/ui/src/components/Tooltip.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Tooltip.tsx` to use package-local imports (`../lib/cn`).
  - Removed app-only `PortalContainerContext` coupling; tooltip now uses default Radix portal behavior.
  - Replaced frontend util dependency by adding package-local `packages/ui/src/lib/platform.ts` (`isMac`, `getModifierKey`).
  - Added `@radix-ui/react-tooltip` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/primitives/AppBar.tsx`
  - `frontend/src/components/ui-new/primitives/AppBarButton.tsx`
  - `frontend/src/components/ui-new/primitives/AppBarSocialLink.tsx`
  - `frontend/src/components/ui-new/primitives/ContextBar.tsx`
  - `frontend/src/components/ui-new/primitives/ContextUsageGauge.tsx`
  - `frontend/src/components/ui-new/primitives/IconButtonGroup.tsx`
  - `frontend/src/components/ui-new/primitives/TodoProgressPopup.tsx`
  - `frontend/src/components/ui-new/primitives/UserAvatar.tsx`
  - `frontend/src/components/ui-new/dialogs/KeyboardShortcutsDialog.tsx`
  - `frontend/src/components/ui-new/containers/CopyButton.tsx`
  - `frontend/src/components/ui-new/primitives/conversation/ChatUserMessage.tsx`
  - `frontend/src/components/ui-new/views/FileTree.tsx`
  - `frontend/src/components/ui-new/views/Navbar.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Additional hidden relative imports of `Tooltip` were surfaced during type-check in containers/views/conversation paths; these were migrated and checks re-run.
- `IconButtonGroup` is now unblocked and is the next recommended `extract-now` candidate.

## 2026-02-21 - UI package extraction: IconButtonGroup

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next `extract-now` component
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/IconButtonGroup.tsx` as the next component because it was the final remaining `extract-now` primitive and had been dependency-unblocked by the prior `Tooltip` extraction.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/IconButtonGroup.tsx packages/ui/src/components/IconButtonGroup.tsx`
- Package updates:
  - Updated `packages/ui/src/components/IconButtonGroup.tsx` to use package-local imports (`../lib/cn`, `./Tooltip`).
  - Replaced `React.ReactNode` namespace usage with explicit `ReactNode` type import for readability.
  - No new package dependencies were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/containers/WorkspacesSidebarContainer.tsx`
  - `frontend/src/components/ui-new/primitives/ViewNavTabs.tsx`
  - `frontend/src/components/ui-new/views/KanbanFilterBar.tsx`
  - `frontend/src/components/ui-new/views/PreviewBrowser.tsx`
  - `frontend/src/components/ui-new/views/PreviewNavigation.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The `extract-now` primitive set from the audit is now complete.
- Next migrations must come from `extract-later` candidates and should prioritize dependency decoupling work (`Popover`, `EmojiPicker`, `CommandBar`, `CollapsibleSectionHeader`) before extraction.

## 2026-02-21 - UI package extraction: Popover

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining `extract-later` set
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/Popover.tsx` as the next candidate because it had low migration risk and a narrow app-only coupling (`PortalContainerContext`).
- `CommandBar` and `CollapsibleSectionHeader` remain higher-coupling candidates; `Popover` provides cleaner dependency unblocking for later primitives.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/Popover.tsx packages/ui/src/components/Popover.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Popover.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed app-only `PortalContainerContext` coupling; `PopoverContent` now uses default Radix portal behavior.
  - Added `@radix-ui/react-popover` to `packages/ui/package.json` dependencies.
  - Synced lockfile via `pnpm install` (`pnpm-lock.yaml` updated).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/dialogs/settings/RemoteProjectsSettingsSection.tsx`
  - `frontend/src/components/ui-new/primitives/SyncErrorIndicator.tsx`
  - `frontend/src/components/ui-new/primitives/AppBar.tsx`
  - `frontend/src/components/ui-new/primitives/TodoProgressPopup.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Hidden relative imports of `Popover` were present in app primitives (`AppBar`, `TodoProgressPopup`) and were migrated in the same cycle.
- Next recommended candidate is `ui-new/primitives/EmojiPicker.tsx`, which can now be aligned on `@vibe/ui/components/Popover` and extracted with lower risk.

## 2026-02-21 - UI package extraction: EmojiPicker

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining `extract-later` set
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/EmojiPicker.tsx` as the next candidate after `Popover` because it now had a minimal dependency surface and only one active callsite.
- The previous app coupling (`PortalContainerContext`) could be removed by aligning the component on `@vibe/ui` `Popover` primitives.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/EmojiPicker.tsx packages/ui/src/components/EmojiPicker.tsx`
- Package updates:
  - Updated `packages/ui/src/components/EmojiPicker.tsx` to use package-local imports (`../lib/cn`, `./Popover`).
  - Removed direct Radix portal/container handling and app-only `PortalContainerContext` coupling.
  - Replaced `React.ReactNode` namespace usage with explicit `ReactNode` type import.
  - No package dependency additions were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Next recommended `extract-later` candidate is `ui-new/primitives/MultiSelectCommandBar.tsx` (already consuming extracted `Command` and with bounded callsite surface), while `CollapsibleSectionHeader` remains blocked by `@/stores` coupling.

## 2026-02-21 - UI package extraction: MultiSelectCommandBar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining `extract-later` set
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/MultiSelectCommandBar.tsx` as the next candidate because it has a small callsite surface and was already aligned on extracted shared primitives (`Command`, `PrimaryButton`).
- No app-context coupling was present, making this a low-risk `extract-later` move.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/MultiSelectCommandBar.tsx packages/ui/src/components/MultiSelectCommandBar.tsx`
- Package updates:
  - Updated `packages/ui/src/components/MultiSelectCommandBar.tsx` to use package-local imports (`./Command`, `./PrimaryButton`).
  - No dependency additions were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/dialogs/AssigneeSelectionDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- No structural plan changes required.
- Remaining high-coupling `extract-later` primitives are `CommandBar` and `CollapsibleSectionHeader`.
- Next recommended candidate is `ui-new/primitives/CollapsibleSectionHeader.tsx`, which can be decoupled by removing direct `@/stores` usage and exposing controlled expansion props.

## 2026-02-21 - UI package extraction: CollapsibleSectionHeader

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining `extract-later` set
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/CollapsibleSectionHeader.tsx` as the next candidate after `MultiSelectCommandBar`.
- It was blocked by direct dependency on `@/stores/useUiPreferencesStore`; extraction required internal state decoupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/CollapsibleSectionHeader.tsx packages/ui/src/components/CollapsibleSectionHeader.tsx`
- Package updates:
  - Updated `packages/ui/src/components/CollapsibleSectionHeader.tsx` to use package-local `cn` (`../lib/cn`).
  - Removed app store coupling (`usePersistedExpanded`, `PersistKey`) and replaced with package-local persisted state logic backed by `localStorage` (`persistKey?: string`).
  - Simplified keyboard handling for action controls to remove unsafe event casting.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`
  - `frontend/src/components/ui-new/views/IssueRelationshipsSection.tsx`
  - `frontend/src/components/ui-new/views/IssueSubIssuesSection.tsx`
  - `frontend/src/components/ui-new/views/IssueWorkspacesSection.tsx`
  - `frontend/src/components/ui-new/views/WorkspacesSidebar.tsx`
  - `frontend/src/components/ui-new/containers/RightSidebar.tsx`
  - `frontend/src/components/ui-new/containers/IssueSubIssuesSectionContainer.tsx`
  - `frontend/src/components/ui-new/containers/IssueWorkspacesSectionContainer.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `CollapsibleSectionHeader` is now unblocked and extracted without app-store dependencies.
- Remaining major `extract-later` primitive with notable app coupling is `ui-new/primitives/CommandBar.tsx` (depends on app action/page models and IDE icon rendering).
- Next recommended cycle should target `CommandBar` with API decoupling (inject icon renderer and resolved item model via props) before or during extraction.

## 2026-02-21 - UI package extraction: CommandBar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining `extract-later` set
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `ui-new/primitives/CommandBar.tsx` as the next candidate because it was the remaining high-coupling primitive in the `@vibe/ui` extraction track.
- Main blocker was direct coupling to app-specific action/page models and app-only icon rendering (`ide-icon`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/CommandBar.tsx packages/ui/src/components/CommandBar.tsx`
- Package updates:
  - Reworked `packages/ui/src/components/CommandBar.tsx` to remove app imports (`@/components/ui-new/actions/*`, `@/components/ide/IdeIcon`).
  - Introduced package-local exported types for command bar data models and made the component generic over action and page ID types.
  - Added `renderSpecialActionIcon` prop so frontend can provide app-specific icon rendering (e.g. `ide-icon`) while keeping `@vibe/ui` decoupled.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/dialogs/CommandBarDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/SelectionDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/selections/ProjectSelectionDialog.tsx`
- App boundary handling:
  - Kept app state machine types unchanged by casting at dialog boundaries where app code still expects `ResolvedGroupItem`.
  - Wired `renderSpecialActionIcon` in `CommandBarDialog` to render IDE icons using `visibilityContext.editorType`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `CommandBar` extraction is now complete and decoupled from app modules.
- Within the audited `ui-new/primitives` extraction track for `@vibe/ui`, there are no remaining high-priority primitive candidates from the prior backlog.
- Next extraction work should likely shift to a new scope (for example `components/ui/wysiwyg` into a dedicated package as noted in audit recommendations) rather than continuing `@vibe/ui` primitive moves.

## 2026-02-21 - UI package extraction: DropdownMenu

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/dropdown-menu.tsx` as the next candidate after `ui-new/primitives` completion.
- It is a reusable UI primitive with moderate callsite surface and low app coupling.
- Main coupling to remove was `PortalContainerContext`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/dropdown-menu.tsx packages/ui/src/components/DropdownMenu.tsx`
- Package updates:
  - Updated `packages/ui/src/components/DropdownMenu.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed app-only `PortalContainerContext` dependency and switched to default Radix portal behavior.
  - No new dependency additions were required (`@radix-ui/react-dropdown-menu` was already present in `@vibe/ui`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/tasks/AgentSelector.tsx`
  - `frontend/src/components/tasks/BranchSelector.tsx`
  - `frontend/src/components/tasks/ConfigSelector.tsx`
  - `frontend/src/components/tasks/RepoSelector.tsx`
  - `frontend/src/components/tasks/VariantSelector.tsx`
  - `frontend/src/components/ui-new/primitives/SubIssueRow.tsx`
  - `frontend/src/components/ui-new/views/IssueWorkspaceCard.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Migration in `components/ui` can continue with low-risk primitives.
- Next recommended candidate is `frontend/src/components/ui/select.tsx` (similar extraction pattern), which will require adding `@radix-ui/react-select` to `packages/ui/package.json` and removing `PortalContainerContext` coupling.
- `frontend/src/components/ui/dialog.tsx` should remain deferred for now due app-level keyboard scope coupling (`react-hotkeys-hook`, `@/keyboard`).

## 2026-02-21 - UI package extraction: Select

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/select.tsx` as the next candidate after `DropdownMenu`.
- It follows the same extraction pattern (Radix primitive + Tailwind styles) and has bounded callsite impact.
- Main coupling to remove was `PortalContainerContext`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/select.tsx packages/ui/src/components/Select.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Select.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed app-only `PortalContainerContext` dependency and switched to default Radix portal behavior.
  - Added explicit `@radix-ui/react-select` dependency to `packages/ui/package.json`.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/org/MemberListItem.tsx`
  - `frontend/src/components/dialogs/tasks/EditorSelectionDialog.tsx`
  - `frontend/src/components/dialogs/org/InviteMemberDialog.tsx`
  - `frontend/src/components/dialogs/CreateWorkspaceFromPrDialog.tsx`
  - `frontend/src/components/dialogs/scripts/ScriptFixerDialog.tsx`
  - `frontend/src/components/dialogs/settings/CreateConfigurationDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `components/ui` extraction can continue with similar low-risk primitives.
- Next recommended candidate is `frontend/src/components/ui/tooltip.tsx` (same portal decoupling pattern, no additional package dependencies expected).
- `frontend/src/components/ui/dialog.tsx` remains deferred due app-level keyboard scope coupling (`react-hotkeys-hook`, `@/keyboard`).

## 2026-02-21 - UI package extraction: ui/tooltip (as RadixTooltip)

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/tooltip.tsx` as the next candidate after `Select`.
- It matches the same low-risk extraction pattern as `DropdownMenu` and `Select` (Radix primitive + app portal decoupling).
- New information: `@vibe/ui` already contains `packages/ui/src/components/Tooltip.tsx` with a different API, so this extracted component needed a distinct filename to preserve readability and avoid API conflicts.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/tooltip.tsx packages/ui/src/components/RadixTooltip.tsx`
- Package updates:
  - Updated `packages/ui/src/components/RadixTooltip.tsx` to use package-local `cn` import (`../lib/cn`).
  - Removed app-only `PortalContainerContext` dependency and switched to default Radix portal behavior.
  - No new package dependencies were required (`@radix-ui/react-tooltip` was already present in `@vibe/ui`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/tasks/BranchSelector.tsx`
  - `frontend/src/components/tasks/Toolbar/GitOperations.tsx`
  - `frontend/src/components/ui-new/views/KanbanIssuePanel.tsx`
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`
  - `frontend/src/components/ui-new/views/KanbanBoard.tsx`
  - `frontend/src/components/NormalizedConversation/PendingApprovalEntry.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Because of the existing `@vibe/ui/components/Tooltip` API, `ui/tooltip.tsx` was extracted under `RadixTooltip` to keep both component interfaces explicit.
- Remaining `components/ui` extract-later candidate is primarily `ui/dialog.tsx`, but it remains high-coupling due keyboard scope integration (`react-hotkeys-hook`, `@/keyboard`).
- Next recommended extraction should either:
  - target `ui/dialog.tsx` with explicit decoupling strategy, or
  - shift to a new package scope (`@vibe/editor-ui`) per audit recommendation.

## 2026-02-21 - UI package extraction: ui/table/table

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/table/table.tsx` as the next candidate.
- Although marked `extract-later` in the audit, it is a low-coupling presentational primitive and was straightforward to package.
- New information: `frontend/src/components/ui/table/data-table.tsx` currently has no imports in `frontend/src`, so this move had minimal callsite risk.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/table/table.tsx packages/ui/src/components/Table.tsx`
- Package updates:
  - Updated `packages/ui/src/components/Table.tsx` to use package-local `cn` import (`../lib/cn`).
  - Preserved the existing component surface (`Table`, `TableHead`, `TableBody`, `TableRow`, `TableHeaderCell`, `TableCell`, `TableEmpty`, `TableLoading`).
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui/table/data-table.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `ui/table/table.tsx` is now fully extracted into `@vibe/ui`.
- Remaining near-term extraction options from this area are:
  - `frontend/src/components/ui/table/data-table.tsx` (now likely easy, but currently unused), or
  - `frontend/src/components/ui/dialog.tsx` (still higher coupling due keyboard scope integration).

## 2026-02-21 - UI package extraction: ui/table/data-table

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/table/data-table.tsx` as the next candidate after `ui/table/table`.
- It is a reusable, low-coupling wrapper around table primitives and straightforward to extract.
- New information: there were no active imports of this file in `frontend/src` at extraction time.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/table/data-table.tsx packages/ui/src/components/DataTable.tsx`
- Package updates:
  - Updated `packages/ui/src/components/DataTable.tsx` to import `Table` primitives via package-local relative path (`./Table`) instead of package self-import.
  - Added explicit React import for type usage consistency in package components.
- Callsite updates:
  - No callsite updates were required because there were no references to `frontend/src/components/ui/table/data-table.tsx`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The `ui/table` extraction track is now fully moved into `@vibe/ui` (`Table` + `DataTable`).
- Remaining `components/ui` extraction candidate is primarily `ui/dialog.tsx`, which is still higher-coupling due keyboard scope integration (`react-hotkeys-hook`, `@/keyboard`).
- After `ui/dialog.tsx`, the next major package split should likely follow the audit recommendation for a dedicated `@vibe/editor-ui` scope (`components/ui/wysiwyg`).

## 2026-02-21 - UI package extraction: ui/dialog (as KeyboardDialog)

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/dialog.tsx` as the next candidate.
- It was the main remaining `components/ui` extraction target after the table components.
- New information: `@vibe/ui` already had `packages/ui/src/components/Dialog.tsx` (Radix-based API), so this extraction required a distinct filename to avoid API collision.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/dialog.tsx packages/ui/src/components/KeyboardDialog.tsx`
- Package updates:
  - Replaced app-only imports (`@/lib/utils`, `@/keyboard`) with package-safe imports and local scope constants.
  - Kept dialog keyboard behavior using `react-hotkeys-hook` directly (`esc` close behavior + `enter` submit behavior, scoped to dialog).
  - Added `react-hotkeys-hook` dependency to `packages/ui/package.json` and synced lockfile.
- Callsite updates to `@vibe/ui` subpath imports:
  - Updated all imports from `@/components/ui/dialog` to `@vibe/ui/components/KeyboardDialog` across dialogs and ui-new dialogs (34 files).

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Dialog extraction is now complete for the legacy app dialog API, without conflicting with existing `@vibe/ui/components/Dialog`.
- Remaining `frontend/src/components/ui/*` files are not strong `@vibe/ui` candidates (`pr-comment-card` is keep-app; `ui/wysiwyg` is better suited for a dedicated `@vibe/editor-ui` package per audit).
- Next package extraction track should likely shift to the editor-scope split.

## 2026-02-21 - UI package extraction: wysiwyg/typeahead-menu-components

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/typeahead-menu-components.tsx` as the next low-risk candidate.
- It is a UI-only component module (no app store/context coupling) and had only two direct callsites.
- New information: remaining extraction work now clusters around the `ui/wysiwyg` subsystem and is better handled as an editor-focused track.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/typeahead-menu-components.tsx packages/ui/src/components/TypeaheadMenu.tsx`
- Package updates:
  - No internal code changes were required in the moved component.
  - No new dependencies were required in `@vibe/ui`.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui/wysiwyg/plugins/file-tag-typeahead-plugin.tsx`
  - `frontend/src/components/ui/wysiwyg/plugins/slash-command-typeahead-plugin.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `TypeaheadMenu` extraction confirms that additional editor primitives can be moved incrementally with low risk.
- Most remaining candidates are `ui/wysiwyg` scoped; practical next step is to continue this editor-oriented extraction path (or formalize it under a dedicated `@vibe/editor-ui` package as recommended by the audit).

## 2026-02-21 - UI package extraction: wysiwyg/task-attempt-context

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/context/task-attempt-context.tsx` as the next low-coupling candidate.
- The module is React-only (no app-only runtime dependencies) and already reused across editor nodes, plugins, hooks, and chat primitives.
- New information: this context is now a shared contract between editor and chat features, so centralizing it in `@vibe/ui` improves consistency.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/context/task-attempt-context.tsx packages/ui/src/components/TaskAttemptContext.tsx`
- Package updates:
  - Kept API unchanged: `TaskAttemptContext`, `useTaskAttemptId`, `LocalImageMetadata`, `LocalImagesContext`, `useLocalImages`.
  - No new package dependencies were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx`
  - `frontend/src/components/ui/wysiwyg/plugins/slash-command-typeahead-plugin.tsx`
  - `frontend/src/components/ui/wysiwyg.tsx`
  - `frontend/src/hooks/useCreateAttachments.ts`
  - `frontend/src/hooks/useImageMetadata.ts`
  - `frontend/src/hooks/useSessionAttachments.ts`
  - `frontend/src/components/ui-new/primitives/ChatBoxBase.tsx`
  - `frontend/src/components/ui-new/primitives/CreateChatBox.tsx`
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Editor-context extraction can proceed incrementally where modules are self-contained and app-agnostic.
- Next likely low-risk candidate is `ui/wysiwyg/context/typeahead-open-context.tsx`, which will require decoupling from app-local `createHmrContext` (`@/lib/hmrContext.ts`) before/while moving.

## 2026-02-21 - UI package extraction: wysiwyg/typeahead-open-context

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/context/typeahead-open-context.tsx` as the next low-risk candidate.
- It is a focused editor state context with bounded usage in `ui/wysiwyg.tsx` and three typeahead-related plugins.
- New information: this module depended on app-local `@/lib/hmrContext.ts`; for package extraction, this was simplified to standard `createContext` to remove frontend-only coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/context/typeahead-open-context.tsx packages/ui/src/components/TypeaheadOpenContext.tsx`
- Package updates:
  - Replaced `createHmrContext` usage with plain React `createContext` in the moved file.
  - Kept API unchanged: `TypeaheadOpenContextType`, `TypeaheadOpenContext`, `TypeaheadOpenProvider`, `useTypeaheadOpen`.
  - No new package dependencies were required.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - `frontend/src/components/ui/wysiwyg/plugins/file-tag-typeahead-plugin.tsx`
  - `frontend/src/components/ui/wysiwyg/plugins/keyboard-commands-plugin.tsx`
  - `frontend/src/components/ui/wysiwyg/plugins/slash-command-typeahead-plugin.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Editor context extraction can continue with small, decoupled modules.
- Next likely low-risk candidate is `ui/wysiwyg/plugins/read-only-link-plugin.tsx` (self-contained lexical plugin with minimal app coupling).

## 2026-02-21 - UI package extraction: wysiwyg/read-only-link-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/read-only-link-plugin.tsx` as the next low-risk candidate.
- It is self-contained editor plugin logic (no app-local imports) and had a single direct callsite in `ui/wysiwyg.tsx`.
- New information: to host this plugin in `@vibe/ui`, lexical package dependencies needed to be declared in `packages/ui`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/read-only-link-plugin.tsx packages/ui/src/components/ReadOnlyLinkPlugin.tsx`
- Package updates:
  - Added `@lexical/react` and `@lexical/link` dependencies to `packages/ui/package.json`.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
  - Plugin implementation stayed unchanged.
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Additional self-contained lexical plugins can move directly into `@vibe/ui` with low risk.
- Next likely low-risk candidate is `ui/wysiwyg/plugins/code-block-shortcut-plugin.tsx` (single callsite, lexical-only dependencies).

## 2026-02-21 - UI package extraction: wysiwyg/code-block-shortcut-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/code-block-shortcut-plugin.tsx` as the next low-risk candidate.
- It is self-contained plugin logic (Lexical + React only) with a single direct callsite in `ui/wysiwyg.tsx`.
- New information: extracting lexical plugins into `@vibe/ui` requires explicitly declaring lexical package dependencies in `packages/ui/package.json` for readability and package correctness.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/code-block-shortcut-plugin.tsx packages/ui/src/components/CodeBlockShortcutPlugin.tsx`
- Package updates:
  - Added `@lexical/code` and `lexical` dependencies to `packages/ui/package.json`.
  - Synced lockfile with `pnpm install`.
  - Plugin implementation remained unchanged.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue moving self-contained lexical plugins first to keep extraction low-risk and readable.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/code-highlight-plugin.tsx` (single callsite, lexical-only dependencies).

## 2026-02-21 - UI package extraction: wysiwyg/code-highlight-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/code-highlight-plugin.tsx` as the next low-risk candidate.
- It is self-contained plugin logic (React + lexical only) with a single direct callsite in `ui/wysiwyg.tsx`.
- New information: `@vibe/ui` already had the required lexical dependencies, so this extraction did not require package dependency changes.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/code-highlight-plugin.tsx packages/ui/src/components/CodeHighlightPlugin.tsx`
- Package updates:
  - No dependency changes required.
  - Plugin implementation remained unchanged.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue moving self-contained lexical plugins first.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/clickable-code-plugin.tsx` (single callsite, no app-local imports; callback props passed by caller).

## 2026-02-21 - UI package extraction: wysiwyg/clickable-code-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/clickable-code-plugin.tsx` as the next low-risk candidate.
- It is self-contained plugin logic (React + lexical context hook only) and had a single callsite in `ui/wysiwyg.tsx`.
- New information: plugin-specific callback props (`findMatchingDiffPath`, `onCodeClick`) already isolate app behavior at the callsite, so package extraction is straightforward.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/clickable-code-plugin.tsx packages/ui/src/components/ClickableCodePlugin.tsx`
- Package updates:
  - No dependency changes were required.
  - Plugin implementation remained unchanged.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue prioritizing self-contained lexical plugins before plugins that import app-local nodes/contexts.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/markdown-sync-plugin.tsx` (single callsite, lexical-only dependencies).

## 2026-02-21 - UI package extraction: wysiwyg/markdown-sync-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/markdown-sync-plugin.tsx` as the next low-risk candidate.
- It is self-contained synchronization logic with one direct callsite in `ui/wysiwyg.tsx` and no app-local imports.
- New information: the moved plugin requires explicit `@lexical/markdown` dependency declaration in `packages/ui` for package correctness.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/markdown-sync-plugin.tsx packages/ui/src/components/MarkdownSyncPlugin.tsx`
- Package updates:
  - Added `@lexical/markdown` to `packages/ui/package.json`.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
  - Plugin implementation remained unchanged.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue extracting self-contained lexical plugins with minimal app-local coupling.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/keyboard-commands-plugin.tsx` (single callsite; no frontend-only imports).

## 2026-02-21 - UI package extraction: wysiwyg/keyboard-commands-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/keyboard-commands-plugin.tsx` as the next low-risk candidate.
- It has a single callsite in `ui/wysiwyg.tsx` and no frontend app-runtime dependencies.
- New information: the plugin had a type-only dependency on `shared/types`, which is not resolvable inside `packages/ui` with current tsconfig settings.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/keyboard-commands-plugin.tsx packages/ui/src/components/KeyboardCommandsPlugin.tsx`
- Package updates:
  - Added `@lexical/list` to `packages/ui/package.json`.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
  - Replaced `import type { SendMessageShortcut } from 'shared/types'` with a local union type (`'ModifierEnter' | 'Enter'`) inside the moved file to remove cross-package coupling.
  - Switched internal import to relative path (`./TypeaheadOpenContext`) for package-local clarity.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- When extracting to `@vibe/ui`, avoid importing app-level generated shared types unless package tsconfig/path support is added; prefer local explicit unions for simple configuration enums.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/paste-markdown-plugin.tsx` (single callsite, lexical-only dependencies).

## 2026-02-21 - UI package extraction: wysiwyg/paste-markdown-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/paste-markdown-plugin.tsx` as the next low-risk candidate.
- It is self-contained plugin logic with lexical-only dependencies and a single callsite in `ui/wysiwyg.tsx`.
- New information: required lexical dependencies were already present in `@vibe/ui`, so no package dependency changes were needed for this move.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/paste-markdown-plugin.tsx packages/ui/src/components/PasteMarkdownPlugin.tsx`
- Package updates:
  - No dependency changes required.
  - Plugin implementation remained unchanged.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining low-level editor plugins (`image-keyboard-plugin`, `component-info-keyboard-plugin`) depend on app-local node guards and need small API decoupling before/while moving.
- Next likely candidate is `frontend/src/components/ui/wysiwyg/plugins/image-keyboard-plugin.tsx` by injecting/passing node guard logic instead of importing app-local node modules directly.

## 2026-02-21 - UI package extraction: wysiwyg/image-keyboard-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/image-keyboard-plugin.tsx` as the next low-risk extraction candidate.
- It has a single callsite in `ui/wysiwyg.tsx` and only required a small decoupling from frontend-local node helpers.
- New information: node guard coupling can be removed cleanly by passing a guard function prop from the app layer.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/image-keyboard-plugin.tsx packages/ui/src/components/ImageKeyboardPlugin.tsx`
- Package updates:
  - Removed direct dependency on frontend-local `image-node` by introducing a component prop:
    - `isTargetNode: (node: LexicalNode) => boolean`
  - Generalized internal deletion logic from image-specific handling to target-node handling.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Passes `$isImageNode` into `<ImageKeyboardPlugin isTargetNode={$isImageNode} />`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- App-specific lexical node predicates should be injected into extracted editor plugins to keep `@vibe/ui` package boundaries clean.
- Next likely candidate is `frontend/src/components/ui/wysiwyg/plugins/component-info-keyboard-plugin.tsx` using the same guard-injection pattern.

## 2026-02-21 - UI package extraction: wysiwyg/component-info-keyboard-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/component-info-keyboard-plugin.tsx` as the next low-risk extraction candidate.
- It had a single callsite in `ui/wysiwyg.tsx` and the same frontend-local node-guard coupling pattern as `image-keyboard-plugin`.
- New information: the guard-injection pattern cleanly generalizes across keyboard deletion plugins.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/component-info-keyboard-plugin.tsx packages/ui/src/components/ComponentInfoKeyboardPlugin.tsx`
- Package updates:
  - Removed direct dependency on frontend-local `component-info-node` by introducing:
    - `isTargetNode: (node: LexicalNode) => boolean`
  - Generalized node filtering/deletion to use the injected predicate.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/components/ComponentInfoKeyboardPlugin`.
  - Passed `$isComponentInfoNode` into `<ComponentInfoKeyboardPlugin isTargetNode={$isComponentInfoNode} />`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue extracting keyboard/editor primitives by injecting app-specific predicates instead of importing frontend-local node modules.
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/plugins/static-toolbar-plugin.tsx` (self-contained lexical formatting UI, likely only requiring package-local utility import adjustment).
- `frontend/src/components/ui/wysiwyg/plugins/toolbar-plugin.tsx` remains higher-coupling because it depends on frontend `PortalContainerContext`.

## 2026-02-21 - UI package extraction: wysiwyg/static-toolbar-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/static-toolbar-plugin.tsx` as the next low-risk extraction candidate.
- It has a single callsite in `ui/wysiwyg.tsx` and is otherwise self-contained lexical formatting UI logic.
- New information: the only decoupling needed was replacing app alias utility import (`@/lib/utils`) with package-local utility import.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/static-toolbar-plugin.tsx packages/ui/src/components/StaticToolbarPlugin.tsx`
- Package updates:
  - Updated `cn` import in moved component:
    - from `@/lib/utils`
    - to `../lib/cn`
  - No dependency changes required.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/components/StaticToolbarPlugin`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining local WYSIWYG plugins are higher-coupling (`toolbar-plugin`, `file-tag-typeahead-plugin`, `slash-command-typeahead-plugin`) due to frontend context/api dependencies.
- Next candidate can still be `frontend/src/components/ui/wysiwyg/plugins/toolbar-plugin.tsx` if we inject portal target via props to remove direct `PortalContainerContext` usage.

## 2026-02-21 - UI package extraction: wysiwyg/toolbar-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/toolbar-plugin.tsx` as the next extraction candidate.
- It had a single callsite in `ui/wysiwyg.tsx` and was blocked mainly by direct `PortalContainerContext` usage plus app alias utility import.
- New information: this dependency can be decoupled cleanly by injecting the portal container from the app layer.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/toolbar-plugin.tsx packages/ui/src/components/ToolbarPlugin.tsx`
- Package updates:
  - Replaced app utility alias import:
    - from `@/lib/utils`
    - to `../lib/cn`
  - Replaced direct context dependency with prop-based injection:
    - added `portalContainer?: HTMLElement | null`
    - removed internal `usePortalContainer()` usage
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/components/ToolbarPlugin`
  - Added `usePortalContainer()` in app layer and passed:
    - `<ToolbarPlugin portalContainer={portalContainer} />`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining local WYSIWYG plugins (`file-tag-typeahead-plugin`, `slash-command-typeahead-plugin`) are now the primary high-coupling items due to frontend API/hooks/store/context dependencies.
- Next candidate likely requires an adapter-prop strategy (inject portal container and async search/command providers) before moving one of those plugins.

## 2026-02-21 - UI package extraction: wysiwyg/slash-command-typeahead-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/slash-command-typeahead-plugin.tsx` as the next extraction candidate.
- It had a single callsite in `ui/wysiwyg.tsx` and was lower-coupling than `file-tag-typeahead-plugin`.
- New information: it depended on app-level context/hook/data sources (`PortalContainerContext`, `useExecutorDiscovery`) and generated shared types, but these were cleanly replaceable with prop injection.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/slash-command-typeahead-plugin.tsx packages/ui/src/components/SlashCommandTypeaheadPlugin.tsx`
- Package updates:
  - Removed app-only imports from moved component (`PortalContainerContext`, `useExecutorDiscovery`, `TaskAttemptContext` read).
  - Replaced shared generated type dependency with local minimal shape:
    - `SlashCommandDescriptionLike` (`name`, optional `description`)
  - Added explicit adapter props:
    - `enabled`
    - `commands`
    - `isInitialized`
    - `isDiscovering`
    - `portalContainer`
  - Switched package-internal imports to relative paths:
    - `./TypeaheadOpenContext`
    - `./TypeaheadMenu`
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/components/SlashCommandTypeaheadPlugin`
  - Added app-side `useSlashCommands(executor, { workspaceId: taskAttemptId, repoId })`
  - Passed discovery results and portal container into plugin props.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining local plugin `file-tag-typeahead-plugin` is now the dominant high-coupling item, due to direct dependencies on app dialogs (`TagEditDialog`, `SelectionDialog`), repo APIs, store preferences, and workspace context.
- Next extraction will likely require a broader adapter boundary (portal + search/create/select behaviors injected via callbacks/data props), or leaving file-tag logic app-local while extracting only shared typeahead presentation utilities.

## 2026-02-21 - UI package extraction: wysiwyg/file-tag-typeahead-plugin

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/plugins/file-tag-typeahead-plugin.tsx` as the next extraction candidate.
- It was the remaining high-coupling WYSIWYG plugin, with direct dependencies on app dialogs (`TagEditDialog`, `SelectionDialog`), workspace context, repo APIs, and UI preference store.
- New information: the plugin can be cleanly extracted by introducing adapter props for app-specific actions/data (`chooseRepo`, `onCreateTag`, `searchTagsAndFiles`, repo preference hooks) while keeping lexical/rendering logic in `@vibe/ui`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/plugins/file-tag-typeahead-plugin.tsx packages/ui/src/components/FileTagTypeaheadPlugin.tsx`
- Package updates:
  - Replaced app imports with prop-based adapters in `packages/ui/src/components/FileTagTypeaheadPlugin.tsx`:
    - repo preference state/actions
    - repo selection callback
    - tag creation callback
    - tag/file search callback
    - portal container + diff path inputs
  - Kept typeahead menu rendering and lexical insertion behavior inside the package component.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local plugin import with `@vibe/ui/components/FileTagTypeaheadPlugin`
  - Wired app adapters from existing frontend modules:
    - `WorkspaceContext` for `diffPaths`
    - `useUiPreferencesStore` for `fileSearchRepoId` / `setFileSearchRepo`
    - `repoApi` for recent repos and repo lookup
    - `SelectionDialog` + `buildRepoSelectionPages` for repo picker flow
    - `TagEditDialog` for tag creation flow
    - `searchTagsAndFiles` for query results

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- All WYSIWYG plugins from `frontend/src/components/ui/wysiwyg/plugins/` are now extracted into `@vibe/ui`.
- Remaining editor-local extraction scope is now node/transformer/theme modules under:
  - `frontend/src/components/ui/wysiwyg/lib/`
  - `frontend/src/components/ui/wysiwyg/nodes/`
  - `frontend/src/components/ui/wysiwyg/transformers/`
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/transformers/table-transformer.ts` because it is lexical-only and has no app-specific dependencies.

## 2026-02-21 - UI package extraction: wysiwyg/table-transformer

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/transformers/table-transformer.ts` as the next low-risk extraction candidate.
- It is lexical-only transformation logic with a single callsite in `frontend/src/components/ui/wysiwyg.tsx`.
- New information: extracting lexical table support into `@vibe/ui` requires `@lexical/table` as a direct dependency in `packages/ui`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/transformers/table-transformer.ts packages/ui/src/lib/table-transformer.ts`
- Package updates:
  - Added `@lexical/table` dependency to `packages/ui/package.json`.
  - Lockfile updated in `pnpm-lock.yaml`.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/lib/table-transformer`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `@vibe/ui` needs explicit lexical dependencies for extracted editor primitives/transformers, even when frontend already depends on them.
- Remaining editor-local extraction scope is now:
  - `frontend/src/components/ui/wysiwyg/lib/`
  - `frontend/src/components/ui/wysiwyg/nodes/`
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/lib/code-highlight-theme.ts` (static theme map, no app-level coupling).

## 2026-02-21 - UI package extraction: wysiwyg/create-decorator-node

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/lib/create-decorator-node.tsx` as the next extraction candidate.
- It is shared lexical/decorator infrastructure reused by multiple editor nodes and has no app-specific imports.
- New information: moving this helper first simplifies future node extraction by reducing remaining local dependencies in `component-info-node.tsx`, `image-node.tsx`, and `pr-comment-node.tsx`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/lib/create-decorator-node.tsx packages/ui/src/components/create-decorator-node.tsx`
- Callsite updates:
  - `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/pr-comment-node.tsx`
  - Each updated to import from `@vibe/ui/components/create-decorator-node`.
- Package updates:
  - No new dependency changes required.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining editor-local scope is now concentrated in node implementations:
  - `frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/pr-comment-node.tsx`
- Next likely low-risk candidate is `frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx` because it now depends only on package-local primitives and shared lexical helper utilities.

## 2026-02-21 - UI package extraction: wysiwyg/code-highlight-theme

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/lib/code-highlight-theme.ts` as a low-risk extraction candidate.
- It is a static token-to-class map with no app-specific dependencies.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/lib/code-highlight-theme.ts packages/ui/src/lib/code-highlight-theme.ts`
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/lib/code-highlight-theme`.
- Package updates:
  - No new dependency changes required.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining local WYSIWYG extraction scope was further narrowed to shared decorator helper + node implementations.

## 2026-02-21 - UI package extraction: wysiwyg/component-info-node

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx` as the next low-risk extraction candidate.
- It now depended only on lexical types and package-level shared primitives (`RadixTooltip`, `create-decorator-node`), with no app-specific imports.
- New information: this move confirms the decorator-node extraction strategy works and significantly reduces remaining frontend-local editor scope.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/nodes/component-info-node.tsx packages/ui/src/components/component-info-node.tsx`
- Package updates:
  - Updated moved file imports to package-relative paths:
    - `./RadixTooltip`
    - `./create-decorator-node`
  - No dependency changes required.
- Callsite update to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local import with `@vibe/ui/components/component-info-node`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining local WYSIWYG nodes are:
  - `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx`
  - `frontend/src/components/ui/wysiwyg/nodes/pr-comment-node.tsx`
- `pr-comment-node.tsx` currently depends on frontend `PrCommentCard`; extraction likely needs either:
  - moving `frontend/src/components/ui/pr-comment-card.tsx` into `@vibe/ui`, or
  - introducing a renderer injection boundary.
- `image-node.tsx` has deeper app coupling (hooks/dialog + attachment/image APIs) and is likely the highest-effort remaining node.
- Next likely candidate: `frontend/src/components/ui/pr-comment-card.tsx` as an enabler for `pr-comment-node.tsx` extraction.

## 2026-02-21 - UI package extraction: ui/pr-comment-card + wysiwyg/pr-comment-node

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/nodes/pr-comment-node.tsx` as the next extraction candidate.
- New information: `frontend/src/components/ui/pr-comment-card.tsx` had already been moved in the current working tree and now serves as an extracted dependency for the node move.
- This allowed a clean completion of the full PR comment rendering chain inside `@vibe/ui`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/pr-comment-card.tsx packages/ui/src/components/pr-comment-card.tsx`
  - `git mv frontend/src/components/ui/wysiwyg/nodes/pr-comment-node.tsx packages/ui/src/components/pr-comment-node.tsx`
- Package updates:
  - `packages/ui/src/components/pr-comment-card.tsx` uses package-local `cn` import (`../lib/cn`).
  - `packages/ui/src/components/pr-comment-node.tsx` now uses package-local imports:
    - `./pr-comment-card`
    - `./create-decorator-node`
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/dialogs/tasks/PrCommentsDialog.tsx`
    - `PrCommentCard` from `@vibe/ui/components/pr-comment-card`
  - `frontend/src/components/ui/wysiwyg.tsx`
    - `PrCommentNode`, `PR_COMMENT_TRANSFORMER`, `PR_COMMENT_EXPORT_TRANSFORMER` from `@vibe/ui/components/pr-comment-node`
  - `frontend/src/components/ui-new/containers/SessionChatBoxContainer.tsx`
    - `NormalizedComment` type from `@vibe/ui/components/pr-comment-node`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Remaining frontend-local WYSIWYG node scope is now:
  - `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx`
- Next extraction likely requires an adapter-prop boundary for app-coupled hooks/APIs used by `image-node.tsx`.

## 2026-02-21 - UI package extraction: wysiwyg/image-node

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate from remaining extraction scope
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui/wysiwyg/nodes/image-node.tsx` as the next extraction candidate.
- It was the last frontend-local WYSIWYG node and had high app coupling via hooks/dialog/utils (`useAttachmentUrl`, `useImageMetadata`, `ImagePreviewDialog`, `downloadBlobUrl`, `formatFileSize`).
- New information: extraction is clean when the node module uses explicit adapter injection for app-only operations.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui/wysiwyg/nodes/image-node.tsx packages/ui/src/components/image-node.tsx`
- Package updates:
  - Reworked `packages/ui/src/components/image-node.tsx` to export a factory:
    - `createImageNode({ fetchAttachmentUrl, openImagePreview })`
  - Removed frontend-only imports from the moved component.
  - Kept metadata + attachment resolution logic package-local via React Query hooks inside `@vibe/ui`.
  - Added package-local helpers for file size formatting and attachment download behavior.
  - Added `@tanstack/react-query` to `packages/ui/package.json` dependencies.
  - Lockfile updated in `pnpm-lock.yaml`.
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui/wysiwyg.tsx`
  - Replaced local node import with `createImageNode` from `@vibe/ui/components/image-node`.
  - Wired app adapters:
    - `fetchAttachmentSasUrl` from `@/lib/remoteApi`
    - `ImagePreviewDialog.show` from `@/components/dialogs/wysiwyg/ImagePreviewDialog`
  - Updated lexical setup to consume the factory output (`ImageNode`, `IMAGE_TRANSFORMER`, `$isImageNode`).

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Frontend-local WYSIWYG node extraction is now complete.
- Remaining app-specific image concerns (modal wiring, attachment URL backend calls) are isolated behind explicit adapter boundaries in `frontend/src/components/ui/wysiwyg.tsx`.
- Next extraction candidate should be chosen from remaining non-node app components still marked reusable, not from `frontend/src/components/ui/wysiwyg/nodes/`.

## 2026-02-21 - UI package extraction: GoogleLogo

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/GoogleLogo.tsx` as the next low-risk extraction candidate.
- New information: primary `extract-now`/`extract-later` reusable primitives from the original audit scope are already extracted, so next moves are selective reevaluations of low-coupling `keep-app` primitives.
- `GoogleLogo` is a pure presentational SVG component with a single callsite and no domain/state dependencies.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/GoogleLogo.tsx packages/ui/src/components/GoogleLogo.tsx`
- Package updates:
  - Updated moved component import from app alias to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/primitives/OAuthButtons.tsx`
  - Replaced local import `./GoogleLogo` with `@vibe/ui/components/GoogleLogo`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Extraction strategy is now in a selective phase: move only low-coupling, clearly reusable primitives that remain in frontend.
- Next candidate should be another standalone presentational primitive with minimal app coupling (e.g., icon/logo/button-adjacent components), not feature containers/views/dialog workflows.

## 2026-02-21 - UI package extraction: OAuthButtons

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/OAuthButtons.tsx` as the next extraction candidate.
- It is a reusable presentational/auth UI primitive with bounded callsites and no app-store/context coupling.
- New information: moving this component requires explicitly declaring `developer-icons` dependency in `@vibe/ui`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/OAuthButtons.tsx packages/ui/src/components/OAuthButtons.tsx`
- Package updates:
  - Updated imports in moved file to package-local paths:
    - `@/lib/utils` -> `../lib/cn`
    - `@vibe/ui/components/GoogleLogo` -> `./GoogleLogo`
  - Added `developer-icons` dependency to `packages/ui/package.json`.
  - Synced lockfile (`pnpm-lock.yaml`) via `pnpm install`.
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/dialogs/global/OAuthDialog.tsx`
  - `frontend/src/pages/ui-new/OnboardingSignInPage.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Selective phase continues: favor primitives with presentational concerns and bounded callsite surfaces.
- Components that rely on icon packs must declare those dependencies in `@vibe/ui` even if frontend already includes them.
- Next likely candidate: another low-coupling primitive (e.g., `PrBadge` or similarly scoped display-only component).

## 2026-02-21 - UI package extraction: PrBadge

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/PrBadge.tsx` as the next extraction candidate.
- It is a low-coupling display primitive used across issue card/tag rendering with a small callsite surface.
- New information: package portability is cleaner if status typing is local to `@vibe/ui` rather than importing from `shared/remote-types`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/PrBadge.tsx packages/ui/src/components/PrBadge.tsx`
- Package updates:
  - Updated import from app alias to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced external shared type import with package-local status union:
    - `PrBadgeStatus = 'open' | 'merged' | 'closed'`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/IssueTagsRow.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Selective extraction phase remains effective for small presentational primitives.
- Prefer package-local union/types for simple display semantics to avoid unnecessary cross-package shared-type coupling.
- Next likely candidate: another display-only primitive with bounded callsites (e.g., `PriorityIcon` or similar).

## 2026-02-21 - UI package extraction: PriorityIcon

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/PriorityIcon.tsx` as the next extraction candidate.
- It is a small display primitive with bounded callsites and no store/context coupling.
- New information: package portability is simpler when `@vibe/ui` owns its local display union type instead of importing from `shared/remote-types`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/PriorityIcon.tsx packages/ui/src/components/PriorityIcon.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced shared remote type import with package-local union:
    - `PriorityLevel = 'urgent' | 'high' | 'medium' | 'low'`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/IssueListRow.tsx`
  - `frontend/src/components/ui-new/views/PriorityFilterDropdown.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`
  - `frontend/src/components/ui-new/views/IssuePropertyRow.tsx`
  - `frontend/src/components/ui-new/primitives/SubIssueRow.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Continue preferring package-local unions for simple UI semantics to keep `@vibe/ui` decoupled from app/domain shared types.
- Next likely candidate: `ui-new/primitives/KanbanBadge.tsx` (small display-only badge with bounded callsites).

## 2026-02-21 - UI package extraction: KanbanBadge

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/KanbanBadge.tsx` as the next extraction candidate.
- It is a display-only primitive with bounded callsites and no app-store/context coupling.
- New information: no additional package dependencies were required; the component only needed `cn` from package-local utils.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/KanbanBadge.tsx packages/ui/src/components/KanbanBadge.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/IssueListRow.tsx`
  - `frontend/src/components/ui-new/views/IssueListSection.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Selective extraction continues to work best for low-coupling display primitives.
- No dependency churn in this move indicates we can prioritize similarly simple components next.
- Next likely candidate: `ui-new/primitives/KanbanAssignee.tsx` (bounded callsites; likely requires a small package-local user shape/type boundary).

## 2026-02-21 - UI package extraction: KanbanAssignee

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/KanbanAssignee.tsx` as the next extraction candidate.
- It is a UI primitive with bounded callsites, but had coupling to app-local `UserAvatar` and `shared/types`.
- New information: extracting this component cleanly required introducing a package-local assignee shape and internal avatar rendering.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/KanbanAssignee.tsx packages/ui/src/components/KanbanAssignee.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced `OrganizationMemberWithProfile` dependency with package-local user shape:
    - `KanbanAssigneeUser`
  - Removed app-local `UserAvatar` dependency by adding package-local `AssigneeAvatar` rendering with tooltip, image fallback, and initials.
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/IssuePropertyRow.tsx`
  - `frontend/src/components/ui-new/views/IssueListRow.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`
  - `frontend/src/components/ui-new/primitives/SubIssueRow.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Keep preferring package-local prop shapes for reusable primitives to avoid cross-package shared type coupling.
- Avatar presentation logic now exists both in `@vibe/ui/components/KanbanAssignee` and frontend `UserAvatar`; next extraction should likely move `UserAvatar` to unify avatar rendering behavior in the package.
- Next likely candidate: `ui-new/primitives/UserAvatar.tsx`.

## 2026-02-21 - UI package extraction: UserAvatar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/UserAvatar.tsx` as the next extraction candidate.
- This followed directly from the prior `KanbanAssignee` extraction, where avatar UI logic was duplicated in `@vibe/ui` and frontend.
- New information: this component can be cleanly extracted by using a package-local user shape rather than importing `OrganizationMemberWithProfile` from `shared/types`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/UserAvatar.tsx packages/ui/src/components/UserAvatar.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced shared type dependency with package-local type:
    - `UserAvatarUser`
  - Switched Tooltip import to package-local component path:
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/dialogs/AssigneeSelectionDialog.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`
  - `frontend/src/components/ui-new/views/IssueCommentsSection.tsx`
  - `frontend/src/components/ui-new/views/IssuePropertyRow.tsx`
  - `frontend/src/components/ui-new/views/IssueWorkspaceCard.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Reusable avatar primitives should stay on package-local user prop shapes to avoid cross-package coupling to app/domain types.
- `KanbanAssignee` now shares avatar presentation concerns with `UserAvatar` inside `@vibe/ui`; follow-up should consolidate `KanbanAssignee` to render `UserAvatar` directly to reduce duplication.
- Next likely extraction candidate: `ui-new/primitives/ViewNavTabs.tsx` (single callsite; would need package-local view/status type boundary).

## 2026-02-21 - UI package extraction: ViewNavTabs

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/ViewNavTabs.tsx` as the next extraction candidate.
- It has a single callsite and low coupling (translation + tab rendering), with only type ties to app/shared modules.
- New information: this component ports cleanly by replacing imported app/shared types with package-local structural types.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ViewNavTabs.tsx packages/ui/src/components/ViewNavTabs.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated internal package import:
    - `@vibe/ui/components/IconButtonGroup` -> `./IconButtonGroup`
  - Replaced app/shared type dependencies with package-local types:
    - `ViewNavMode = 'kanban' | 'list'`
    - `ViewNavStatus = { id: string; name: string }`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/containers/KanbanContainer.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Simple UI components that only need identity/label fields should use package-local structural prop types to avoid app type coupling.
- As extraction continues, the remaining candidates have more behavior coupling (dialogs, store interactions, command dispatch), so adapter-prop boundaries will be required more often.
- Next likely extraction candidate: `ui-new/primitives/WorkspaceSummary.tsx` (move with adapter boundary for command-bar action + date formatting).

## 2026-02-21 - UI package extraction: WorkspaceSummary

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/WorkspaceSummary.tsx` as the next extraction candidate.
- It is mostly presentational but had app-coupled behavior via `CommandBarDialog.show` and app date utility imports.
- New information: this component extracts cleanly by using an action callback adapter and package-local relative-time formatting.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/WorkspaceSummary.tsx packages/ui/src/components/WorkspaceSummary.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/RunningDots` -> `./RunningDots`
  - Removed app-coupled imports from moved component:
    - `formatRelativeTime` from `@/utils/date`
    - `CommandBarDialog` from `@/components/ui-new/dialogs/CommandBarDialog`
  - Added package-local relative-time helper `formatRelativeElapsed`.
  - Added adapter prop to package component:
    - `onOpenWorkspaceActions?: (workspaceId: string) => void`
- Callsite updates to `@vibe/ui` subpath import and adapter wiring:
  - `frontend/src/components/ui-new/views/WorkspacesSidebar.tsx`
  - Replaced local import with `@vibe/ui/components/WorkspaceSummary`
  - Added local `handleOpenWorkspaceActions` that calls `CommandBarDialog.show(...)`
  - Passed `onOpenWorkspaceActions={handleOpenWorkspaceActions}` to all workspace-backed `WorkspaceSummary` callsites.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Behavior-coupled primitives can still move cleanly by introducing explicit adapter props for app-only actions.
- Keep package-local helpers for generic display logic (like elapsed-time labels) when they don't need app state.
- Next likely candidate: reduce duplication by refactoring `@vibe/ui/components/KanbanAssignee` to reuse `@vibe/ui/components/UserAvatar` internally before selecting another extraction target.

## 2026-02-21 - UI package extraction: AppBarSocialLink

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/AppBarSocialLink.tsx` as the next extraction candidate.
- It had the lowest coupling among remaining primitives: one callsite in `AppBar.tsx`, no app state/store hooks, and only styling + tooltip dependencies.
- New information: this component can be moved without introducing adapter props or app-type bridges.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/AppBarSocialLink.tsx packages/ui/src/components/AppBarSocialLink.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/primitives/AppBar.tsx`
  - Replaced local import with `@vibe/ui/components/AppBarSocialLink`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Small leaf primitives used by larger app-shell components can be extracted incrementally with minimal risk.
- A dedicated adapter layer is unnecessary for primitives that already expose only presentational props.
- Next likely extraction candidate: `ui-new/primitives/AppBarButton.tsx` (same app-shell cluster, similarly low coupling).

## 2026-02-21 - UI package extraction: AppBarButton

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/AppBarButton.tsx` as the next extraction candidate.
- It had a single callsite in `AppBar.tsx` and no app state/store coupling.
- New information: this component ports directly with package-local utility/component imports and no adapter props.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/AppBarButton.tsx packages/ui/src/components/AppBarButton.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/primitives/AppBar.tsx`
  - Replaced local import with `@vibe/ui/components/AppBarButton`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- App-shell leaf primitives can continue to be extracted incrementally without adapter boundaries when they expose presentational-only props.
- For remaining primitives, prioritize low-coupling components with limited callsites and minimal app-utility dependencies.
- Next likely extraction candidate: `ui-new/primitives/ProcessListItem.tsx` (single callsite; can be decoupled with package-local enum/string unions and relative-time helper).

## 2026-02-21 - UI package extraction: ProcessListItem

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/ProcessListItem.tsx` as the next extraction candidate.
- It had a single callsite in `ProcessListContainer.tsx` and no direct store/context coupling.
- New information: this component can be made package-safe by replacing app/shared type dependencies with plain string props plus internal mapping helpers.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ProcessListItem.tsx packages/ui/src/components/ProcessListItem.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/RunningDots` -> `./RunningDots`
  - Removed app/shared dependencies from moved component:
    - `formatRelativeTime` from `@/utils/date`
    - `ExecutionProcessStatus` / `ExecutionProcessRunReason` from `shared/types`
  - Added package-local helpers:
    - `formatRelativeElapsed` for relative time labels
    - `getRunReasonLabel`, `getRunReasonIcon`, `getStatusColor` for resilient rendering from string inputs
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/containers/ProcessListContainer.tsx`
  - Replaced local import with `@vibe/ui/components/ProcessListItem`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For process/log primitives, using string-based props with explicit internal mapping improves package decoupling and avoids shared enum coupling.
- Unknown/future run reasons and statuses now degrade safely in the UI component (default icon/color/label behavior).
- Next likely extraction candidate: `ui-new/primitives/TodoProgressPopup.tsx` (single callsite; similar decoupling strategy for `TodoItem` shape and package-local imports).

## 2026-02-21 - UI package extraction: TodoProgressPopup

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/TodoProgressPopup.tsx` as the next extraction candidate.
- It had a single callsite in `SessionChatBox.tsx` and was mostly presentational.
- New information: this component ports cleanly by replacing `shared/types` `TodoItem` with a package-local structural item type.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/TodoProgressPopup.tsx packages/ui/src/components/TodoProgressPopup.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self imports:
    - `@vibe/ui/components/Popover` -> `./Popover`
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
  - Replaced shared type dependency with package-local structural type:
    - `TodoProgressItem { content: string; status?: string | null }`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
  - Replaced local import with `@vibe/ui/components/TodoProgressPopup`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Structural prop typing continues to work well for decoupling package components from app/shared generated types.
- Leaf components using package-local popover/tooltip wrappers are straightforward to migrate with minimal behavioral risk.
- Next likely extraction candidate: `ui-new/primitives/RelationshipBadge.tsx` (small presentational component; app utility coupling can be removed via package-local label mapping).

## 2026-02-21 - UI package extraction: RelationshipBadge

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/RelationshipBadge.tsx` as the next extraction candidate.
- It is a small presentational component with no state/store coupling and a limited callsite set.
- New information: app coupling was only through `@/lib/resolveRelationships` type/label helpers and can be removed by defining package-local relationship types and labels.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/RelationshipBadge.tsx packages/ui/src/components/RelationshipBadge.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced app helper/type dependency with package-local definitions:
    - Added local `RelationshipDisplayType` union
    - Added local `getRelationshipLabel` mapping
- Callsite updates to `@vibe/ui` subpath imports:
  - `frontend/src/components/ui-new/views/IssueListRow.tsx`
  - `frontend/src/components/ui-new/views/KanbanCardContent.tsx`
  - `frontend/src/components/ui-new/views/IssueRelationshipsSection.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Utility-label logic for small visual primitives can be duplicated intentionally in-package when it removes app-only imports and keeps package boundaries clear.
- `ResolvedRelationship` in frontend remains compatible with package-local `RelationshipDisplayType` because the union members are identical.
- Next likely extraction candidate: `ui-new/primitives/PropertyDropdown.tsx` (presentational generic component; app coupling is limited to `cn` alias import).

## 2026-02-21 - UI package extraction: PropertyDropdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/PropertyDropdown.tsx` as the next extraction candidate.
- It is a presentational generic dropdown component with no state/store coupling and only minimal app import coupling.
- New information: migration is straightforward because all existing callsites already pass primitive/generic props compatible with the package component API.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/PropertyDropdown.tsx packages/ui/src/components/PropertyDropdown.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/containers/WorkspacesSidebarContainer.tsx`
  - `frontend/src/components/ui-new/dialogs/KanbanFiltersDialog.tsx`
  - Updated both value + type imports (`PropertyDropdown`, `PropertyDropdownOption`) to `@vibe/ui/components/PropertyDropdown`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Generic presentational controls port cleanly when their value/type contracts are already local and explicit at callsites.
- Subpath imports remain readable even for shared type imports from package components (`type PropertyDropdownOption`).
- Next likely extraction candidate: `ui-new/primitives/SyncErrorIndicator.tsx` (single callsite; requires adapter props to decouple from `SyncErrorContext`).

## 2026-02-21 - UI package extraction: SyncErrorIndicator

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/SyncErrorIndicator.tsx` as the next extraction candidate.
- It had a single callsite in `Navbar.tsx` and the only blocking coupling was direct `SyncErrorContext` usage.
- New information: context-coupled leaf UI components migrate cleanly when converted to explicit data/callback props at the package boundary.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SyncErrorIndicator.tsx packages/ui/src/components/SyncErrorIndicator.tsx`
- Package updates:
  - Removed frontend-only context dependency:
    - deleted `useSyncErrorContext` import from moved component
  - Updated package self import:
    - `@vibe/ui/components/Popover` -> `./Popover`
  - Added package-safe API:
    - `SyncErrorIndicatorError` and `SyncErrorIndicatorProps`
    - component now accepts `errors` and optional `onRefreshPage`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/Navbar.tsx`
  - replaced local primitive import with `@vibe/ui/components/SyncErrorIndicator`
  - added `useSyncErrorContext` in `Navbar` and passed `errors={syncErrorContext?.errors}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For small UI primitives tied to app context, a thin app-side adapter (context read in callsite + plain props into package) keeps package boundaries readable without overengineering.
- Keep package components context-agnostic and structurally typed where possible for faster incremental extractions.
- Next likely extraction candidate: `ui-new/primitives/ContextUsageGauge.tsx` (single callsite in `SessionChatBox`; can be decoupled from `TokenUsageInfo` via package-local structural props).

## 2026-02-21 - UI package extraction: ContextUsageGauge

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/ContextUsageGauge.tsx` as the next extraction candidate.
- It had a single callsite in `SessionChatBox.tsx` and no app store/context coupling.
- New information: the only package-boundary coupling was `TokenUsageInfo` from `shared/types`, which can be replaced by a local structural interface.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ContextUsageGauge.tsx packages/ui/src/components/ContextUsageGauge.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
  - Replaced shared type dependency with package-local structural type:
    - added `ContextUsageInfo { total_tokens: number; model_context_window: number }`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
  - Replaced local import with `@vibe/ui/components/ContextUsageGauge`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Structural typing for telemetry-like props (counts/limits) decouples package components from generated shared types without callsite churn.
- Single-callsite primitives continue to be the fastest low-risk extraction path.
- Next likely extraction candidate: `ui-new/primitives/CommentCard.tsx` (presentational primitive with simple `cn` coupling and three straightforward container callsites).

## 2026-02-21 - UI package extraction: CommentCard

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/CommentCard.tsx` as the next extraction candidate.
- It is a presentational component with no store/context coupling and exactly three straightforward container callsites.
- New information: migration is low-risk because the component API (`variant`, `header`, `actions`, `children`) is already fully declarative.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/CommentCard.tsx packages/ui/src/components/CommentCard.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Tightened React type import:
    - `import type { ReactNode } from 'react'`
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/containers/ReviewCommentRenderer.tsx`
  - `frontend/src/components/ui-new/containers/CommentWidgetLine.tsx`
  - `frontend/src/components/ui-new/containers/GitHubCommentRenderer.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Leaf presentational wrappers with prop-driven content remain the highest-throughput extraction path.
- Converging container imports on `@vibe/ui/components/*` keeps boundaries readable and mechanical for repeated migrations.
- Next likely extraction candidate: `ui-new/primitives/RepoCard.tsx` (requires lifting `useRepoAction` store coupling into callsites via explicit selected-action props).

## 2026-02-21 - UI package extraction: RepoCard

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/RepoCard.tsx` as the next extraction candidate.
- It is heavily reused inside Git panel flows, and its only hard package-boundary blocker was direct `useRepoAction` store usage.
- New information: this component can be package-safe by turning selection persistence into explicit props while keeping state orchestration in frontend views.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/RepoCard.tsx packages/ui/src/components/RepoCard.tsx`
- Package updates:
  - Removed frontend store dependency from package component:
    - deleted `useRepoAction` import/usage
  - Updated package self imports:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
    - `@vibe/ui/components/SplitButton` -> `./SplitButton`
  - Added explicit controlled-selection API:
    - `selectedAction?: RepoAction`
    - `onSelectedActionChange?: (action: RepoAction) => void`
    - default `selectedAction` remains `'pull-request'`
- Frontend callsite updates:
  - `frontend/src/components/ui-new/views/GitPanel.tsx`
    - switched import to `@vibe/ui/components/RepoCard`
    - introduced `RepoCardWithPreference` wrapper that owns `useRepoAction(repo.id)` and passes controlled props into `RepoCard`
  - `frontend/src/components/ui-new/containers/GitPanelContainer.tsx`
    - updated `RepoAction` type import to `@vibe/ui/components/RepoCard`
- Frontend type import updates:
  - `frontend/src/stores/useUiPreferencesStore.ts`
  - `frontend/src/hooks/useUiPreferencesScratch.ts`
  - both now import `RepoAction` from `@vibe/ui/components/RepoCard`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Store-coupled primitives can be extracted cleanly by making package components controlled/presentational and introducing thin frontend wrappers for persistence hooks.
- Consolidating shared domain types (like `RepoAction`) under package component exports keeps store/hooks/frontend views aligned without local primitive imports.
- Next likely extraction candidate: `ui-new/primitives/SubIssueRow.tsx` (single callsite; move is feasible by replacing shared type imports with structural props and package-local utilities).

## 2026-02-21 - UI package extraction: SubIssueRow

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/SubIssueRow.tsx` as the next extraction candidate.
- It had a single callsite in `IssueSubIssuesSection.tsx` and mostly reused existing package components (`PriorityIcon`, `StatusDot`, `KanbanAssignee`, `DropdownMenu`).
- New information: this component introduces drag-and-drop usage in `@vibe/ui`, so `@hello-pangea/dnd` needed to be declared in the package dependencies.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SubIssueRow.tsx packages/ui/src/components/SubIssueRow.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self imports:
    - `@vibe/ui/components/PriorityIcon` -> `./PriorityIcon`
    - `@vibe/ui/components/StatusDot` -> `./StatusDot`
    - `@vibe/ui/components/KanbanAssignee` -> `./KanbanAssignee`
    - `@vibe/ui/components/DropdownMenu` -> `./DropdownMenu`
  - Removed shared type coupling with package-local types:
    - `IssuePriority` -> `PriorityLevel`
    - `OrganizationMemberWithProfile[]` -> `KanbanAssigneeUser[]`
  - Added explicit package dependency:
    - `packages/ui/package.json`: `@hello-pangea/dnd`
    - lockfile updated (`pnpm-lock.yaml`)
- Callsite updates to `@vibe/ui` subpath import:
  - `frontend/src/components/ui-new/views/IssueSubIssuesSection.tsx`
  - Replaced local primitive import with `@vibe/ui/components/SubIssueRow`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Drag/drop primitives migrate cleanly when package dependencies are declared explicitly instead of relying on frontend-only dependency declarations.
- Structural prop typing (`PriorityLevel`, `KanbanAssigneeUser`) keeps package components decoupled from generated shared types while preserving compatibility at callsites.
- Next likely extraction candidate: `ui-new/primitives/SearchableTagDropdown.tsx` (container-managed state already exists; requires decoupling from `shared/remote-types` `Tag` and app-local `PRESET_COLORS` import).

## 2026-02-21 - UI package extraction: SearchableTagDropdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/SearchableTagDropdown.tsx` as the next extraction candidate (as identified in the previous log entry).
- It is container-managed and mostly presentational; package-boundary blockers were app/shared imports (`@/lib/utils`, `@/lib/colors`, and `shared/remote-types` `Tag`).
- New information: the existing `TAG_COLORS` compatibility export can remain by sourcing palette values from `@vibe/ui` `ColorPicker` instead of frontend color utilities.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SearchableTagDropdown.tsx packages/ui/src/components/SearchableTagDropdown.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self imports:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
    - `@vibe/ui/components/ColorPicker` -> `./ColorPicker`
  - Removed shared type coupling with package-local structural type:
    - `Tag` -> `SearchableTag`
  - Preserved color compatibility export:
    - `TAG_COLORS` now aliases `PRESET_COLORS` from `packages/ui/src/components/ColorPicker.tsx`
  - Exported `PRESET_COLORS` from `ColorPicker` for intra-package reuse.
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/SearchableTagDropdownContainer.tsx`
    - switched primitive import to `@vibe/ui/components/SearchableTagDropdown`
    - replaced `PRESET_COLORS` usage with `TAG_COLORS`
  - `frontend/src/components/ui-new/views/IssueTagsRow.tsx`
    - updated `TAG_COLORS` re-export path to `@vibe/ui/components/SearchableTagDropdown`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Shared visual constants (like color palettes) should live in `@vibe/ui` when both package components and frontend containers need them.
- Structural typing continues to be sufficient for package boundaries, avoiding direct dependency on generated shared type modules for presentational primitives.
- Next likely extraction candidate: `ui-new/primitives/AppBarUserPopover.tsx` (fully callback-driven; requires decoupling `OrganizationWithRole` to structural props and moving `cn` import to package-local utility).

## 2026-02-21 - UI package extraction: AppBarUserPopover

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/AppBarUserPopover.tsx` as the next extraction candidate.
- It is callback-driven and presentational, with one container callsite and no direct store/query coupling.
- New information: the only package-boundary blockers were app utility import (`@/lib/utils`), package self-import via package name, and shared `OrganizationWithRole` type coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/AppBarUserPopover.tsx packages/ui/src/components/AppBarUserPopover.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
  - Replaced shared type coupling with package-local structural type:
    - `OrganizationWithRole[]` -> `AppBarUserOrganization[]`
    - `AppBarUserOrganization` only requires `{ id: string; name: string }`
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/AppBarUserPopoverContainer.tsx`
    - switched primitive import to `@vibe/ui/components/AppBarUserPopover`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Structural organization props are enough for app-bar selection UI; package components do not need full domain role models.
- Remaining `ui-new/primitives` components are increasingly app-specific; future moves will likely require lifting app hooks/state into containers first.
- Next likely extraction candidate: `ui-new/primitives/AppBar.tsx` (requires lifting `useDiscordOnlineCount` and `useGitHubStars` data hooks into props before a clean package boundary).

## 2026-02-21 - UI package extraction: AppBar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/AppBar.tsx` as the next extraction candidate.
- It had one frontend callsite (`SharedAppLayout`) but was blocked by package-boundary violations: app hooks (`useDiscordOnlineCount`, `useGitHubStars`), app container dependency (`AppBarUserPopoverContainer`), app alias utility import (`@/lib/utils`), and shared type imports.
- New information: moving `AppBar` cleanly is straightforward once dynamic data/UI dependencies are passed in as props from the app shell.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/AppBar.tsx packages/ui/src/components/AppBar.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self imports:
    - `@vibe/ui/components/AppBarButton` -> `./AppBarButton`
    - `@vibe/ui/components/AppBarSocialLink` -> `./AppBarSocialLink`
    - `@vibe/ui/components/Popover` -> `./Popover`
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
  - Removed app/container coupling from package component:
    - removed direct `AppBarUserPopoverContainer` usage
    - added `userPopover?: ReactNode` prop
  - Removed app data-hook coupling from package component:
    - removed `useDiscordOnlineCount` and `useGitHubStars`
    - added `onlineCount?: number | null` and `starCount?: number | null` props
  - Removed shared type coupling:
    - `RemoteProject` -> package-local structural `AppBarProject { id, name, color }`
  - Avoided new package dependency by lifting icon asset inputs:
    - added required props `githubIconPath` and `discordIconPath` (instead of importing `simple-icons` in package)
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/SharedAppLayout.tsx`
    - switched `AppBar` import to `@vibe/ui/components/AppBar`
    - added app-shell data hooks (`useDiscordOnlineCount`, `useGitHubStars`)
    - passed `userPopover` as `<AppBarUserPopoverContainer ... />`
    - passed `onlineCount`, `starCount`, and icon paths (`siGithub.path`, `siDiscord.path`)

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Complex app-shell components can still move to `@vibe/ui` when frontend-only hooks/containers are lifted to caller-provided props.
- Passing composition slots (`userPopover`) plus computed data (`onlineCount`, `starCount`) keeps package code readable without adding app/runtime coupling.
- Next likely extraction candidate: `ui-new/primitives/ChatBoxBase.tsx` (requires splitting out app-only dependencies: `WYSIWYGEditor`, `useUserSystem`, and `ModelSelectorContainer` into injectable props/components before package move).

## 2026-02-21 - UI package extraction: ChatBoxBase

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/ChatBoxBase.tsx` as the next extraction candidate.
- It sat on a key boundary between reusable chat layout and app-specific editor/model-selector wiring.
- New information: moving this component cleanly is feasible by turning it into a pure layout shell and injecting app-only editor/model-selector nodes from frontend callsites.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ChatBoxBase.tsx packages/ui/src/components/ChatBoxBase.tsx`
- Package updates:
  - Updated app alias import to package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Updated package self import:
    - `@vibe/ui/components/Toolbar` -> `./Toolbar`
  - Removed app/runtime coupling from package component:
    - removed direct `WYSIWYGEditor`, `useUserSystem`, and `ModelSelectorContainer` usage
    - removed shared-type dependencies used only for editor/model selector plumbing
  - Simplified component API to layout composition:
    - `editor` is now a `ReactNode`
    - `modelSelector` is now a `ReactNode`
    - retained layout concerns (`headerLeft`, `headerRight`, `footerLeft`, `footerRight`, `banner`, `visualVariant`, `dropzone`, `isRunning`, `error`)
- Frontend callsite updates:
  - `frontend/src/components/ui-new/primitives/CreateChatBox.tsx`
    - switched `ChatBoxBase` import to `@vibe/ui/components/ChatBoxBase`
    - moved editor rendering into callsite via inline `WYSIWYGEditor`
    - moved model selector rendering into callsite via `ModelSelectorContainer`
    - exported `EditorProps` / `ModelSelectorProps` locally for shared use
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
    - switched `ChatBoxBase` import to `@vibe/ui/components/ChatBoxBase`
    - moved editor rendering into callsite via inline `WYSIWYGEditor`
    - moved model selector rendering into callsite via `ModelSelectorContainer`
    - imported shared editor/model-selector prop types from `CreateChatBox`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Package components stay readable and decoupled when app-owned dependencies are passed as composed nodes rather than imported directly.
- This extraction pattern scales for other high-coupling primitives: first move shared layout shell, then keep app-specific hooks/renderers in frontend wrappers.
- Next likely extraction candidate: `ui-new/primitives/ContextBar.tsx` (requires decoupling from `useContextBarPosition`, action visibility hooks, and app-only icon/button renderers via injected state/callback props).

## 2026-02-21 - UI package extraction: ContextBar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/ContextBar.tsx` as the next extraction candidate.
- It had a single container callsite, but package-boundary blockers were significant: app drag-position hook (`useContextBarPosition`), app action visibility logic (`useActionVisibilityContext`, `isActionVisible`, `isActionEnabled`, `getActionIcon`, `getActionTooltip`), and app-only renderers (`IdeIcon`, `CopyButton`).
- New information: this component extracts cleanly when the package component is reduced to presentational rendering and the container owns all app-dependent action/drag logic.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/ContextBar.tsx packages/ui/src/components/ContextBar.tsx`
- Package updates:
  - Replaced app alias import with package-local utility:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self import:
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
  - Removed app-boundary dependencies from package component:
    - no `useContextBarPosition`
    - no action visibility/action icon resolution hooks
    - no `IdeIcon` / `CopyButton`
  - Introduced presentational API:
    - `ContextBarRenderItem` (`action` or `divider`)
    - props now accept `style`, `isDragging`, `onDragHandleMouseDown`, `primaryItems`, `secondaryItems`
    - supports either standard icon action rows or `customContent` rows for app-provided renderers
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/ContextBarContainer.tsx`
    - switched primitive import to `@vibe/ui/components/ContextBar`
    - moved drag-position state ownership into container via `useContextBarPosition(containerRef)`
    - moved action visibility and icon/tooltip resolution into container
    - mapped `ContextBarActionGroups` into package `ContextBarRenderItem[]`
    - preserved special action rendering (`ide-icon`, `copy-icon`) by passing `customContent`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For high-coupling primitives, a reliable extraction pattern is: keep package components purely presentational and move app state/behavior adapters to containers.
- The remaining top-level `ui-new/primitives` are now `CreateChatBox.tsx` and `SessionChatBox.tsx`, both highly app-coupled.
- Next likely extraction candidate: `ui-new/primitives/CreateChatBox.tsx` (feasible after introducing package-safe structural types and converting app-only helpers/containers to injected props, similar to the `ChatBoxBase` pattern).

## 2026-02-21 - UI package extraction: CreateChatBox

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/CreateChatBox.tsx` as the next extraction candidate.
- It had one direct callsite (`CreateChatBoxContainer`) and one type-sharing dependency (`SessionChatBox` importing its prop types), making it a lower-risk extraction than `SessionChatBox`.
- Main package-boundary blockers were frontend-only dependencies inside the component (`AgentIcon`, `WYSIWYGEditor`, `ModelSelectorContainer`, `useUserSystem`, and `@/utils/string`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/CreateChatBox.tsx packages/ui/src/components/CreateChatBox.tsx`
- Package updates:
  - Replaced all `@/` and frontend container imports with package-safe APIs.
  - Converted `CreateChatBox` to a presentational package component with injected app renderers:
    - added `renderEditor` render-prop (`CreateChatBoxEditorRenderProps`)
    - added `agentIcon?: ReactNode`
    - changed `modelSelector` from config object to `ReactNode`
  - Added generic package-safe types that no longer depend on `shared/types`:
    - `ExecutorProps<TExecutor extends string = string>`
    - `ModelSelectorProps<TExecutorConfig = unknown>`
  - Added `formatExecutorLabel` / `emptyExecutorLabel` props to keep label formatting behavior at the app layer.
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/CreateChatBoxContainer.tsx`
    - switched import to `@vibe/ui/components/CreateChatBox`
    - injected editor via `renderEditor` using app-owned `WYSIWYGEditor`
    - injected `AgentIcon` and `ModelSelectorContainer`
    - passed `formatExecutorLabel={toPrettyCase}` to preserve existing executor label formatting
  - `frontend/src/components/ui-new/primitives/SessionChatBox.tsx`
    - moved shared type imports to `@vibe/ui/components/CreateChatBox`
    - parameterized shared types for app-specific types (`ExecutorProps<BaseCodingAgent>`, `ModelSelectorProps<ExecutorConfig>`)

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The render-prop + injected-node pattern is working for chat primitives that wrap `ChatBoxBase` and need app-owned editor/model integrations.
- Top-level `ui-new/primitives` now contains only `SessionChatBox.tsx` (plus `conversation/` and `model-selector/` subfolders).
- Next likely extraction candidate: `ui-new/primitives/SessionChatBox.tsx` (using the same package-presentational + frontend adapter pattern, while lifting remaining app hooks/actions and mode-specific orchestration to container-level inputs where needed).

## 2026-02-21 - UI package extraction: SessionChatBox

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/SessionChatBox.tsx` as the next extraction candidate.
- It was the final remaining top-level primitive in `ui-new/primitives` after the `CreateChatBox` extraction.
- Main package-boundary blockers were frontend-only dependencies embedded inside the component: `WYSIWYGEditor`, `AgentIcon`, `ModelSelectorContainer`, action visibility helpers (`isSpecialIcon`, `isActionEnabled`, `getActionTooltip`), app utility formatters (`toPrettyCase`, `formatDateShortWithTime`), and `useUserSystem`-driven context-usage capability checks.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/SessionChatBox.tsx packages/ui/src/components/SessionChatBox.tsx`
- Package updates:
  - Replaced frontend-bound imports with package-local imports (`./ChatBoxBase`, `./CreateChatBox`, `./Toolbar`, `./Dropdown`, `./PrimaryButton`, `./ContextUsageGauge`, `./TodoProgressPopup`, `./TaskAttemptContext`).
  - Converted component API to a package-safe presentational contract:
    - added `renderEditor` render-prop (`SessionChatBoxEditorRenderProps`) for app-owned editor wiring
    - changed `modelSelector` from config object behavior to `ReactNode`
    - added adapter props for app-specific rendering/formatting:
      - `renderAgentIcon`
      - `formatExecutorLabel`
      - `formatSessionDate`
      - `supportsContextUsage`
    - replaced action-definition/context coupling with precomputed toolbar items:
      - `SessionToolbarActionItem[]` via `toolbarActions.items`
  - Introduced package-safe structural types for session/todo/context usage:
    - `SessionOption`
    - `TodoProgressItem` usage
    - `ContextUsageInfo` usage
- Frontend callsite updates:
  - `frontend/src/components/ui-new/containers/SessionChatBoxContainer.tsx`
    - switched import to `@vibe/ui/components/SessionChatBox`
    - injected editor rendering through `renderEditor` using app-owned `WYSIWYGEditor`
    - injected agent icon rendering through `renderAgentIcon` using app-owned `AgentIcon`
    - injected session date and executor label formatting (`formatDateShortWithTime`, `toPrettyCase`)
    - moved toolbar action enablement/tooltip/icon filtering into the container (`isSpecialIcon`, `isActionEnabled`, `getActionTooltip`)
    - replaced old `toolbarActions` shape with precomputed `toolbarActions.items`
    - moved context-usage capability calculation into container via `useUserSystem().capabilities`
    - injected model selector UI as `modelSelector` node (`ModelSelectorContainer`)

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The presentational-component + container-adapter pattern also scales to deeply stateful chat primitives without leaking app hooks into the package.
- `frontend/src/components/ui-new/primitives` now has no top-level files; remaining candidates are under `conversation/` and `model-selector/`.
- Next likely extraction candidate: `ui-new/primitives/conversation/ToolStatusDot.tsx` (small, widely reused, low-coupling primitive; extraction should only require package-local `cn` and structural status typing).

## 2026-02-21 - UI package extraction: ToolStatusDot

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ToolStatusDot.tsx` as the next extraction candidate.
- It had low coupling and broad reuse across conversation primitives, with one clear package-boundary issue: direct dependence on `@/lib/utils` and `shared/types`.
- New information: this component extracts cleanly by using package-local `cn` and a structural status type (`{ status: string }`) rather than app/shared type imports.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ToolStatusDot.tsx packages/ui/src/components/ToolStatusDot.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` with exported package type `ToolStatusLike` (`status: string`)
- Frontend callsite updates:
  - Updated all conversation primitives importing local `./ToolStatusDot` to import package component:
    - `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedDiffEntries.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedToolEntries.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/ChatFileEntry.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/ChatScriptEntry.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/ChatToolSummary.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/PierreConversationDiff.tsx`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Conversation-level UI atoms can be extracted incrementally without moving the full conversation rendering stack.
- The current package boundary remains stable when status-like API shapes are structural and narrow.
- Next likely extraction candidate: `ui-new/primitives/conversation/ChatErrorMessage.tsx` (single callsite in `NewDisplayConversationEntry`, very low coupling, straightforward alias-to-package import cleanup).

## 2026-02-21 - UI package extraction: ChatErrorMessage

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatErrorMessage.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and minimal dependencies (`@phosphor-icons/react` + `cn` helper), making it a low-risk conversation primitive extraction.
- New information: no shared-type or app-context coupling was present, so a direct package move with import cleanup was sufficient.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatErrorMessage.tsx packages/ui/src/components/ChatErrorMessage.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatErrorMessage`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The conversation-primitives extraction path remains straightforward for small presentational components with no store/context coupling.
- The package boundary remains stable when moved components depend only on package-local utilities and third-party UI libs.
- Next likely extraction candidate: `ui-new/primitives/conversation/ChatScriptPlaceholder.tsx` (single container callsite; likely only requires alias import cleanup and callsite import update).

## 2026-02-22 - UI package extraction: ChatScriptPlaceholder

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatScriptPlaceholder.tsx` as the next extraction candidate.
- It had a single frontend callsite (`ConversationListContainer`) and low coupling (icons, i18n, and `cn`), making it a low-risk move.
- New information: this component required no API redesign; package-boundary compliance was achieved by switching only the `cn` import to package-local utilities.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatScriptPlaceholder.tsx packages/ui/src/components/ChatScriptPlaceholder.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/ConversationListContainer.tsx`
  - New import path:
    - `@vibe/ui/components/ChatScriptPlaceholder`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The conversation extraction stream remains stable for presentational components with narrow prop surfaces and no context/store dependencies.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatEntryContainer.tsx` (shared across multiple conversation renderers, minimal dependency surface, and straightforward package-boundary cleanup).

## 2026-02-22 - UI package extraction: ChatEntryContainer

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatEntryContainer.tsx` as the next extraction candidate.
- It had two direct callsites (`ChatApprovalCard`, `ChatUserMessage`) and a bounded dependency surface (`@phosphor-icons/react`, `cn`, and a `ToolStatus` shape), making it a low-risk shared-conversation primitive move.
- New information: `ToolStatus` can stay package-safe as a structural type (`{ status: string }`), avoiding direct shared-type coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatEntryContainer.tsx packages/ui/src/components/ChatEntryContainer.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` with exported package type `ChatEntryStatusLike` (`status: string`)
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/primitives/conversation/ChatApprovalCard.tsx`
    - `frontend/src/components/ui-new/primitives/conversation/ChatUserMessage.tsx`
  - New import path:
    - `@vibe/ui/components/ChatEntryContainer`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The conversation extraction path remains stable when shared status/state props are represented as structural package types.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatSystemMessage.tsx` (single container callsite, minimal dependencies, straightforward alias import cleanup).

## 2026-02-22 - UI package extraction: ChatSystemMessage

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatSystemMessage.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and minimal dependencies (icon + `cn`), making it a low-risk conversation primitive move.
- New information: this extraction required only alias cleanup; no API reshaping was needed.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatSystemMessage.tsx packages/ui/src/components/ChatSystemMessage.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatSystemMessage`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The conversation extraction path remains stable for single-callsite presentational components with no context/store coupling.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatTodoList.tsx` (single container callsite, no local component dependencies, and straightforward structural typing for todo items).

## 2026-02-22 - UI package extraction: ChatTodoList

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatTodoList.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and no local component imports, making it a low-risk presentational conversation primitive.
- New information: todo status values can be nullable in practice, so package-local structural typing must permit `null`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatTodoList.tsx packages/ui/src/components/ChatTodoList.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct shared-type dependency:
    - replaced `TodoItem` with exported package type `TodoItemLike` (`content: string`, `status?: string | null`)
  - Updated internal helper typing to match nullable status:
    - `getStatusIcon(status?: string | null)`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatTodoList`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For conversation primitives that consume normalized entry data, package types should explicitly model nullable fields from runtime payloads.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatAssistantMessage.tsx` (single callsite, but requires package-safe decoupling from app-bound `ChatMarkdown`, likely via render-prop injection).

## 2026-02-22 - UI package extraction: ChatAssistantMessage

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatAssistantMessage.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) but one key package-boundary blocker: direct dependency on app-local `ChatMarkdown`.
- New information: this extracts cleanly by converting the package component to a presentational wrapper that receives markdown rendering via a render prop.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatAssistantMessage.tsx packages/ui/src/components/ChatAssistantMessage.tsx`
- Package updates:
  - Replaced app-bound markdown dependency with injected renderer API:
    - added `ChatAssistantMessageRenderProps`
    - added required `renderMarkdown` prop
  - Component now renders via `renderMarkdown({ content, workspaceId })`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatAssistantMessage`
  - Added app-owned markdown adapter in callsite:
    - imports local `ChatMarkdown`
    - passes `renderMarkdown={({ content, workspaceId }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Conversation components that wrap `ChatMarkdown` should be extracted as package-presentational wrappers with injected renderers to avoid leaking app editor/context dependencies.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatApprovalCard.tsx` (same markdown-injection pattern plus structural status typing, with contained callsite impact).

## 2026-02-22 - UI package extraction: ChatApprovalCard

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatApprovalCard.tsx` as the next extraction candidate.
- It had contained callsite impact (two usage points in `NewDisplayConversationEntry`) and one clear package-boundary blocker: direct app-local markdown rendering dependency.
- New information: the component also depended on `ToolStatus` from shared types, which is unnecessary at package boundary and can be represented structurally.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatApprovalCard.tsx packages/ui/src/components/ChatApprovalCard.tsx`
- Package updates:
  - Replaced app-bound markdown dependency with injected renderer API:
    - added `ChatApprovalCardRenderProps`
    - added required `renderMarkdown` prop
    - component now renders markdown via `renderMarkdown({ content, workspaceId })`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` prop with package-safe structural type via `ChatEntryStatusLike`
  - Updated package import boundary:
    - switched self-import to local path (`./ChatEntryContainer`)
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatApprovalCard`
  - Updated both callsites to pass app-owned markdown renderer:
    - `renderMarkdown={({ content, workspaceId }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Plan/approval conversation components can be extracted safely with the same renderer-injection pattern used for assistant messages.
- Shared status objects remain stable as structural UI props, avoiding cross-package type lock-in.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatUserMessage.tsx` (single callsite and same markdown-injection pattern, with existing controls already package-safe).

## 2026-02-22 - UI package extraction: ChatUserMessage

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatUserMessage.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and already depended on extracted UI primitives, so scope was constrained.
- New information: the only package-boundary blocker was direct `ChatMarkdown` usage, which matches the existing renderer-injection pattern already used by `ChatAssistantMessage` and `ChatApprovalCard`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatUserMessage.tsx packages/ui/src/components/ChatUserMessage.tsx`
- Package updates:
  - Replaced package self-imports to local paths:
    - `@vibe/ui/components/ChatEntryContainer` -> `./ChatEntryContainer`
    - `@vibe/ui/components/Tooltip` -> `./Tooltip`
  - Replaced app-local markdown dependency with injected renderer API:
    - added `ChatUserMessageRenderProps`
    - added required `renderMarkdown` prop
    - component now renders markdown via `renderMarkdown({ content, workspaceId })`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatUserMessage`
  - Added markdown adapter prop in `UserMessageEntry`:
    - `renderMarkdown={({ content, workspaceId }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- User-entry conversation components extract cleanly when app-bound markdown rendering is injected from the container layer.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatThinkingMessage.tsx` (single callsite and the same markdown-injection pattern with minimal dependency surface).

## 2026-02-22 - UI package extraction: ChatThinkingMessage

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatThinkingMessage.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and a narrow dependency surface (icon + `cn` + markdown rendering), making it a low-risk move.
- New information: markdown styling (`className="text-sm"`) needs to stay configurable from the package component, so the injected renderer contract should carry optional markdown className.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatThinkingMessage.tsx packages/ui/src/components/ChatThinkingMessage.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced app-local markdown dependency with injected renderer API:
    - added `ChatThinkingMessageRenderProps` (`content`, `workspaceId`, `className`)
    - added required `renderMarkdown` prop
    - component now renders markdown via `renderMarkdown({ content, workspaceId: taskAttemptId, className: 'text-sm' })`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatThinkingMessage`
  - Added markdown adapter prop in thinking entry render:
    - `renderMarkdown={({ content, workspaceId, className }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For markdown-backed conversation components, render-prop contracts should carry style passthrough when the UI package controls layout-level typography.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatCollapsedThinking.tsx` (single container callsite, conversation-local presentational behavior, and same markdown-injection boundary pattern).

## 2026-02-22 - UI package extraction: ChatCollapsedThinking

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatCollapsedThinking.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and a contained dependency surface (icons, `cn`, translation, and markdown rendering), making it a low-risk extraction.
- New information: this component needs markdown style passthrough (`className="text-sm"`) per row, so the renderer contract should include optional `className` in addition to `content` and `workspaceId`.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatCollapsedThinking.tsx packages/ui/src/components/ChatCollapsedThinking.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced app-local markdown dependency with injected renderer API:
    - added `ChatCollapsedThinkingRenderProps` (`content`, `workspaceId`, `className`)
    - added required `renderMarkdown` prop
    - component now renders each entry via `renderMarkdown({ content, workspaceId: taskAttemptId, className: 'text-sm' })`
  - Preserved exported `ThinkingEntry` for typed callers.
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatCollapsedThinking`
  - Added markdown adapter prop in `AggregatedThinkingGroupEntry`:
    - `renderMarkdown={({ content, workspaceId, className }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For grouped markdown list renderers, package components should pass per-item markdown className through render-prop contracts to keep layout ownership in the package while preserving app renderer control.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatToolSummary.tsx` (single container callsite and no app context dependencies; primarily alias and status typing cleanup).

## 2026-02-22 - UI package extraction: ChatToolSummary

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatToolSummary.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and no app-context dependencies, making it a low-risk extraction.
- New information: status typing can stay package-local by reusing `ToolStatusLike` from `ToolStatusDot`, avoiding direct `shared/types` coupling for this UI primitive.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatToolSummary.tsx packages/ui/src/components/ChatToolSummary.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self-import:
    - `@vibe/ui/components/ToolStatusDot` -> `./ToolStatusDot`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` with `ToolStatusLike` imported from `ToolStatusDot`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatToolSummary`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Conversation status-bearing primitives can standardize on package-local structural status typing (`ToolStatusLike`) rather than importing shared type models.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatSubagentEntry.tsx` (single callsite; requires markdown renderer injection plus structural type cleanup for result/status props).

## 2026-02-22 - UI package extraction: ChatSubagentEntry

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatSubagentEntry.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and no app-context hook dependencies, making it a good next extraction target.
- New information: this component needed both package-local structural typing (`status`, `result`) and markdown renderer injection to remove direct app/shared coupling.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatSubagentEntry.tsx packages/ui/src/components/ChatSubagentEntry.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct shared-type dependencies:
    - replaced `ToolStatus` with package-local structural `ToolStatusLike`
    - replaced `ToolResult` with package-local structural `ChatSubagentResultLike`
  - Replaced app-local markdown dependency with injected renderer API:
    - added `ChatSubagentEntryRenderProps`
    - added required `renderMarkdown` prop
    - component now renders output via `renderMarkdown({ content, workspaceId })`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatSubagentEntry`
  - Added markdown adapter prop in `SubagentEntry`:
    - `renderMarkdown={({ content, workspaceId }) => <ChatMarkdown ... />}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Subagent/task conversation components extract cleanly with structural status/result types plus render-prop injection for markdown output.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatScriptEntry.tsx` (single callsite; requires decoupling from `useLogsPanel` via callback prop and structural status typing).

## 2026-02-22 - UI package extraction: ChatScriptEntry

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatScriptEntry.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and one app-context dependency (`useLogsPanel`), making it a good candidate after replacing context access with an injected callback prop.
- New information: log-panel behavior should remain in the frontend container layer while the package component receives a simple callback (`onViewProcess`).

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatScriptEntry.tsx packages/ui/src/components/ChatScriptEntry.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self-import:
    - `@vibe/ui/components/ToolStatusDot` -> `./ToolStatusDot`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` with `ToolStatusLike` imported from `ToolStatusDot`
  - Removed app-context coupling:
    - added required `onViewProcess` prop
    - click handler now calls `onViewProcess(processId)`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatScriptEntry`
  - Injected logs panel callback from container:
    - `onViewProcess={viewProcessInPanel}`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For conversation components needing app contexts (logs, navigation, stores), extraction should use callback props so app-specific behavior stays in frontend containers.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedToolEntries.tsx` (single container callsite; likely alias and status-type decoupling only).

## 2026-02-22 - UI package extraction: ChatAggregatedToolEntries

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedToolEntries.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and no app-context dependencies, making it a low-risk extraction.
- New information: aggregate conversation list primitives can follow the same structural-status pattern used by other extracted components.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatAggregatedToolEntries.tsx packages/ui/src/components/ChatAggregatedToolEntries.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self-import:
    - `@vibe/ui/components/ToolStatusDot` -> `./ToolStatusDot`
  - Removed direct shared-type dependency:
    - replaced `ToolStatus` with `ToolStatusLike` imported from `ToolStatusDot`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatAggregatedToolEntries`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Aggregated conversation renderers that only need status display can stay package-local by using `ToolStatusLike`, without importing shared models.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatFileEntry.tsx` (single callsite, but requires decoupling from theme/file-icon/VSCode bridge and diff-render dependencies via injected props or package-local adapters).

## 2026-02-22 - UI package extraction: ChatFileEntry

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatFileEntry.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) but relied on app-specific integrations (theme resolution, file icon mapping, VSCode bridge, and diff rendering hooks).
- New information: this component extracts cleanly when app-specific behavior is injected as explicit adapter props, keeping package UI reusable while preserving frontend-owned integrations.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatFileEntry.tsx packages/ui/src/components/ChatFileEntry.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced direct shared-type dependency:
    - `ToolStatus` -> `ToolStatusLike`
  - Removed frontend-only dependencies (`ThemeProvider`, `fileTypeIcon`, `vscode/bridge`, `PierreConversationDiff` hooks/components)
  - Added explicit adapter API:
    - `fileIcon?: React.ElementType`
    - `isVSCode?: boolean`
    - `onOpenInVSCode?: (filename: string) => void`
    - `renderDiffBody?: (diffContent) => React.ReactNode`
  - Added package-local diff input export:
    - `ChatFileEntryDiffInput`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatFileEntry`
  - Added frontend adapter wiring in `FileEditEntry`:
    - icon adapter via `getFileIcon(path, actualTheme)`
    - VSCode adapter via `inIframe()` / `openFileInVSCode`
    - diff renderer adapter via new `FileEntryDiffBody` helper (`useDiffData` + `DiffViewBody`)
    - diff validity gating before passing `diffContent`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For components that mix reusable UI with environment integrations, extraction should favor a package component plus frontend adapter props rather than pulling app services into `@vibe/ui`.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedDiffEntries.tsx` (single callsite; similar theme/icon/VSCode/diff dependencies and likely same adapter-based decoupling pattern).

## 2026-02-22 - UI package extraction: ChatAggregatedDiffEntries

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatAggregatedDiffEntries.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) but depended on app-specific integrations (theme/icon resolution, VSCode bridge, and diff rendering hooks/components).
- New information: grouped diff UI extracts cleanly with the same adapter approach used for `ChatFileEntry`, while keeping app integrations in the container layer.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatAggregatedDiffEntries.tsx packages/ui/src/components/ChatAggregatedDiffEntries.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct shared-type coupling:
    - replaced `ToolStatus` with `ToolStatusLike`
    - replaced `ActionType` extraction with package-local structural `ChatAggregatedDiffChange`
  - Removed frontend-only dependencies (`ThemeProvider`, `fileTypeIcon`, `vscode/bridge`, `PierreConversationDiff` hooks/components, frontend diff stats util)
  - Added explicit adapter API:
    - `fileIcon?: React.ElementType`
    - `isVSCode?: boolean`
    - `onOpenInVSCode?: (filePath: string) => void`
    - `renderDiffBody?: ({ filePath, change, diffContent }) => React.ReactNode`
  - Added package-local unified diff stats parser helper to avoid frontend utility coupling.
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatAggregatedDiffEntries`
  - Added frontend adapter wiring in `AggregatedDiffGroupEntry`:
    - icon adapter via `getFileIcon(group.filePath, actualTheme)`
    - VSCode adapter via `inIframe()` / `openFileInVSCode`
    - diff renderer adapter via existing `FileEntryDiffBody`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Components that combine reusable list chrome with environment-specific rendering should expose a small set of adapter props (`icon`, `environment`, `body renderer`) to keep package code reusable and readable.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/ChatMarkdown.tsx` (single container callsite; requires decoupling from `useChangesView` and app-local WYSIWYG bindings via injected renderer callbacks).

## 2026-02-22 - UI package extraction: ChatMarkdown

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/ChatMarkdown.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) but directly depended on app-specific integrations (`useChangesView` and app-local `WYSIWYGEditor`).
- New information: markdown display extraction is cleanest when the package component owns layout/styling and the app injects renderer behavior.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/ChatMarkdown.tsx packages/ui/src/components/ChatMarkdown.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed frontend-only dependencies (`useChangesView`, `WYSIWYGEditor`)
  - Added render adapter API:
    - `renderContent: (props) => ReactNode`
  - Added reusable render props type:
    - `ChatMarkdownRenderProps`
  - Package component now handles markdown class composition and max-width layout, while delegating rendering via `renderContent`.
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/ChatMarkdown`
  - Added frontend wrapper component:
    - `AppChatMarkdown` (injects `WYSIWYGEditor`, `findMatchingDiffPath`, and `onCodeClick` from `useChangesView`)
  - Updated all markdown callsites in `NewDisplayConversationEntry` render adapters to use `AppChatMarkdown`.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- For content-rendering primitives, extraction should keep package responsibility to UI layout and style contracts while passing app-specific rendering and navigation hooks as explicit adapters.
- No structural plan changes were required this cycle.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/conversation/PierreConversationDiff.tsx` (last remaining conversation primitive in frontend; heavier due `@pierre/diffs` integration and diff view store coupling).

## 2026-02-22 - UI package extraction: PierreConversationDiff

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/conversation/PierreConversationDiff.tsx` as the next extraction candidate.
- It had a single frontend callsite (`NewDisplayConversationEntry`) and still contained app-only dependencies (`@/` aliases, diff store hooks, theme/file icon helpers, shared type imports, frontend style path).
- New information: this diff renderer extracts cleanly when `@vibe/ui` owns the rendering logic and accepts app-owned runtime configuration (`diffMode`, theme, icon) through explicit props.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/conversation/PierreConversationDiff.tsx packages/ui/src/components/PierreConversationDiff.tsx`
- Package updates:
  - Replaced app aliases and shared type coupling:
    - `@/lib/utils` -> `../lib/cn`
    - `ToolStatus` -> `ToolStatusLike`
  - Removed frontend store/theme dependencies from package internals:
    - removed `useDiffViewMode`, `useWrapTextDiff`, `useIgnoreWhitespaceDiff`, `useTheme`, `getActualTheme`, `getFileIcon`
  - Added explicit package API for host adapters:
    - `DiffViewTheme`, `DiffViewMode`
    - `DiffViewCard` now accepts `theme`, optional `diffMode`, optional `wrapText`, optional `ignoreWhitespace`, optional `fileIcon`
    - `DiffViewBody` now accepts optional `diffMode` and optional `invalidMessage`
  - Inlined diff stat parsing helper in the package module to avoid frontend util dependency.
  - Added package-local style asset for `@pierre/diffs` overrides:
    - `packages/ui/src/styles/diff-style-overrides.css`
    - `PierreConversationDiff` now imports `../styles/diff-style-overrides.css`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/NewDisplayConversationEntry.tsx`
  - New import path:
    - `@vibe/ui/components/PierreConversationDiff`
  - Added `useDiffViewMode()` in container and passed `diffMode` into `DiffViewBody` to preserve global split/unified behavior.
- Workspace/package config updates:
  - Added `@pierre/diffs` dependency to `packages/ui/package.json`
  - Ran `pnpm install` to update lockfile/workspace resolution.

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅ (after `pnpm install`)
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Conversation primitive extraction from `frontend/src/components/ui-new/primitives/conversation/` is now complete.
- Remaining `ui-new/primitives` files are only `model-selector` primitives; continuing extraction likely requires a decision on whether model/provider domain UI should remain app-owned or move into `@vibe/ui`.
- Next likely candidate if extraction continues: `frontend/src/components/ui-new/primitives/model-selector/ModelProviderIcon.tsx` (smallest surface area in the remaining primitive set).

## 2026-02-22 - UI package extraction: ModelProviderIcon

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/model-selector/ModelProviderIcon.tsx` as the next extraction candidate.
- Although the audit originally marked model-selector primitives as app-owned, this file had the smallest standalone surface area and a single callsite in `ModelSelectorPopover`, making it a low-risk extraction.
- New information: theme-coupled visual primitives can still live in `@vibe/ui` cleanly when the app passes resolved theme as a simple prop.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/model-selector/ModelProviderIcon.tsx packages/ui/src/components/ModelProviderIcon.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Removed direct frontend theme dependency (`useTheme`, `getResolvedTheme`) from package internals.
  - Added explicit API:
    - `theme?: 'light' | 'dark'` (default `'light'`)
  - Icon suffix (`-dark` / `-light`) is now derived from this explicit prop.
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx`
  - New import path:
    - `@vibe/ui/components/ModelProviderIcon`
  - Added frontend theme adapter wiring:
    - `useTheme()` + `getResolvedTheme(theme)`
    - pass `theme={resolvedTheme}` to `ModelProviderIcon`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The model-selector area is now partially extracted (`ModelProviderIcon` in `@vibe/ui`, `ModelList`/`ModelSelectorPopover` still in frontend).
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/model-selector/ModelList.tsx`.
  - It will require decoupling from frontend utilities (`getModelKey`, `getReasoningLabel`) via injected formatter helpers or by moving those pure helpers into `@vibe/ui`.

## 2026-02-22 - UI package extraction: ModelList

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/model-selector/ModelList.tsx` as the next extraction candidate.
- It had a single callsite (`ModelSelectorPopover`) and moderate coupling to frontend-only helpers (`getModelKey`, `getReasoningLabel`, `toPrettyCase`) plus shared type imports.
- New information: this primitive can be extracted cleanly by embedding small pure helper logic in the package component and using structural prop types rather than shared model imports.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/model-selector/ModelList.tsx packages/ui/src/components/ModelList.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self-import:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
  - Removed frontend utility coupling by adding package-local helpers:
    - `toPrettyCase`
    - `getReasoningLabel`
    - `getModelKey`
  - Removed shared type coupling by defining structural package-local types:
    - `ModelReasoningOption`
    - `ModelListModel`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx`
  - New import path:
    - `@vibe/ui/components/ModelList`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- Model-selector extraction now includes `ModelProviderIcon` and `ModelList` in `@vibe/ui`.
- Remaining model-selector primitive in frontend: `ModelSelectorPopover`.
- Next likely extraction candidate: `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx`.
  - It still depends on frontend-specific model selection/recency helpers (`getSelectedModel`, `sortByRecency`, `sortProvidersByRecency`), so extraction will likely require injected data transforms or moving pure helper logic into package-local modules.

## 2026-02-22 - UI package extraction: ModelSelectorPopover

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Selected `frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx` as the next extraction candidate.
- It had a single callsite (`ModelSelectorContainer`) but depended on frontend-only model selection/recency helpers and theme provider hooks.
- New information: this component can be fully extracted by using structural config/model/provider types, package-local helper logic, and a simple `resolvedTheme` adapter prop from the frontend container.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/primitives/model-selector/ModelSelectorPopover.tsx packages/ui/src/components/ModelSelectorPopover.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
  - Replaced package self-imports:
    - `@vibe/ui/components/Dropdown` -> `./Dropdown`
    - `@vibe/ui/components/Accordion` -> `./Accordion`
    - `@vibe/ui/components/ModelProviderIcon` -> `./ModelProviderIcon`
    - `@vibe/ui/components/ModelList` -> `./ModelList`
  - Removed frontend utility/theme coupling by adding package-local helpers:
    - `getSelectedModel`
    - `getModelKey`
    - `getRecentIndex`
    - `sortByRecency`
    - `sortProvidersByRecency`
  - Removed `shared/types` dependency in this component via structural types:
    - `ModelSelectorProvider`
    - `ModelSelectorConfigLike`
  - Added adapter prop:
    - `resolvedTheme?: 'light' | 'dark'` (default `'light'`)
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/ModelSelectorContainer.tsx`
  - New import path:
    - `@vibe/ui/components/ModelSelectorPopover`
  - Added frontend theme adapter wiring:
    - `useTheme()` + `getResolvedTheme(theme)`
    - pass `resolvedTheme={resolvedTheme}` to `ModelSelectorPopover`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- `frontend/src/components/ui-new/primitives/` no longer contains any `.tsx` primitives; extraction of this primitive layer is now complete.
- Next migration work should be chosen from other layers based on current architecture goals (likely `ui-new/views` or selected `ui-new/dialogs` primitives), since there are no remaining `ui-new/primitives` components to move.

## 2026-02-22 - UI package extraction: MigrateSidebar

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- With `ui-new/primitives` exhausted, selected `frontend/src/components/ui-new/views/MigrateSidebar.tsx` as the next low-risk candidate.
- It is a small presentational view with a single callsite (`MigrateLayout`) and no app-state or context dependencies.
- New information: extracting select lightweight `ui-new/views` components is viable when they are pure view widgets and can be consumed from containers without additional adapters.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/views/MigrateSidebar.tsx packages/ui/src/components/MigrateSidebar.tsx`
- Package updates:
  - Replaced app alias import:
    - `@/lib/utils` -> `../lib/cn`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/MigrateLayout.tsx`
  - New import path:
    - `@vibe/ui/components/MigrateSidebar`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- After completing primitives, migration can continue incrementally by extracting pure, presentational components from `ui-new/views`.
- Next likely candidate: `frontend/src/components/ui-new/views/PreviewControls.tsx` or similar lightweight view-level widgets with narrow callsite surfaces.

## 2026-02-22 - UI package extraction: PreviewNavigation

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Evaluated `frontend/src/components/ui-new/views/PreviewControls.tsx` first, but it pulls in additional view-level behavior (`VirtualizedProcessLogs`) and frontend utility coupling.
- Selected `frontend/src/components/ui-new/views/PreviewNavigation.tsx` as the lower-risk next move: it is presentational and has a single callsite in `PreviewBrowser`.
- New information: for `ui-new/views`, extraction remains practical when the component surface is narrow and frontend-specific types are replaced with structural package-local types.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/views/PreviewNavigation.tsx packages/ui/src/components/PreviewNavigation.tsx`
- Package updates:
  - Replaced package self-import:
    - `@vibe/ui/components/IconButtonGroup` -> `./IconButtonGroup`
  - Removed frontend type coupling:
    - `@/types/previewDevTools`
  - Added package-local structural type:
    - `PreviewNavigationState`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/views/PreviewBrowser.tsx`
  - New import path:
    - `@vibe/ui/components/PreviewNavigation`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The audit's broad `keep-app` classification for `ui-new/views` still holds as a default, but selective extraction is working for low-coupling view widgets.
- Next candidate should be another single-callside, presentational view component; avoid components that pull in container logic or frontend-only infra until we define adapter boundaries.

## 2026-02-22 - UI package extraction: MigrateIntroduction

Plan checklist update:
- [x] Read `docs/frontend-ui-library-refactor-audit.md`
- [x] Read existing `progress.txt`
- [x] Assess next component candidate to move into `@vibe/ui`
- [x] Move component with `git mv` before refactor edits
- [x] Update all frontend callsites
- [x] Run quality checks (`format`, `frontend:check`, `ui:check`, `frontend:lint`, `ui:lint`)
- [x] Update plan status and append progress log

Assessment:
- Considered additional `ui-new/views` candidates; `PreviewControls` is still higher-coupling due to frontend container and utility dependencies.
- Selected `frontend/src/components/ui-new/views/MigrateIntroduction.tsx` as the next low-risk extraction.
- It is presentational, has a single callsite (`MigrateIntroductionContainer`), and required only package-local import cleanup.

Refactor completed:
- Moved with history preservation:
  - `git mv frontend/src/components/ui-new/views/MigrateIntroduction.tsx packages/ui/src/components/MigrateIntroduction.tsx`
- Package updates:
  - Replaced package self-import:
    - `@vibe/ui/components/PrimaryButton` -> `./PrimaryButton`
- Frontend callsite updates:
  - Updated import in:
    - `frontend/src/components/ui-new/containers/MigrateIntroductionContainer.tsx`
  - New import path:
    - `@vibe/ui/components/MigrateIntroduction`

Validation:
- `pnpm run format` ✅
- `pnpm run frontend:check` ✅
- `pnpm run ui:check` ✅
- `pnpm run frontend:lint` ✅
- `pnpm run ui:lint` ✅

Plan adjustments from new information:
- The migrate-flow view set contains more extraction-friendly components (single container callsite, mostly presentational structure).
- Next candidate should stay in that low-coupling subset before tackling more integrated views.
